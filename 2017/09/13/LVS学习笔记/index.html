<!doctype html>



  


<html class="theme-next mist use-motion" lang="zh-Hans">
<head>
  <meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>






<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />















  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css" />




  
  
  
  

  
    
    
  

  

  

  

  

  
    
    
    <link href="//fonts.googleapis.com/css?family=Lato:300,300italic,400,400italic,700,700italic&subset=latin,latin-ext" rel="stylesheet" type="text/css">
  






<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css" />

<link href="/css/main.css?v=5.1.1" rel="stylesheet" type="text/css" />


  <meta name="keywords" content="Linux学习笔记,keepalived," />





  <link rel="alternate" href="/atom.xml" title="斯堪的纳维亚" type="application/atom+xml" />




  <link rel="shortcut icon" type="image/x-icon" href="http://pozzv8y5g.bkt.clouddn.com/favicon.png?v=5.1.1" />






<meta name="description" content="LVS简介   负载均衡技术有很多实现方案，有基于DNS域名轮流解析的方法、有基于客户端调度访问的方法、有基于应用层系统负载的调度方法，还有基于IP地址的调度方法。本文介绍LVS目前有三种IP负载均衡技术（VS/NAT、VS/TUN和VS/DR）。">
<meta name="keywords" content="Linux学习笔记,keepalived">
<meta property="og:type" content="article">
<meta property="og:title" content="LVS学习笔记">
<meta property="og:url" content="http://yjscloud.site/2017/09/13/LVS学习笔记/index.html">
<meta property="og:site_name" content="斯堪的纳维亚">
<meta property="og:description" content="LVS简介   负载均衡技术有很多实现方案，有基于DNS域名轮流解析的方法、有基于客户端调度访问的方法、有基于应用层系统负载的调度方法，还有基于IP地址的调度方法。本文介绍LVS目前有三种IP负载均衡技术（VS/NAT、VS/TUN和VS/DR）。">
<meta property="og:image" content="http://ow78pfxd9.bkt.clouddn.com/VS:NAT.png">
<meta property="og:image" content="http://ow78pfxd9.bkt.clouddn.com/TUNNEL.png">
<meta property="og:image" content="http://ow78pfxd9.bkt.clouddn.com/VS:DR.png">
<meta property="og:image" content="http://ow78pfxd9.bkt.clouddn.com/find.png">
<meta property="og:updated_time" content="2018-08-30T04:41:05.000Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="LVS学习笔记">
<meta name="twitter:description" content="LVS简介   负载均衡技术有很多实现方案，有基于DNS域名轮流解析的方法、有基于客户端调度访问的方法、有基于应用层系统负载的调度方法，还有基于IP地址的调度方法。本文介绍LVS目前有三种IP负载均衡技术（VS/NAT、VS/TUN和VS/DR）。">
<meta name="twitter:image" content="http://ow78pfxd9.bkt.clouddn.com/VS:NAT.png">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Mist',
    sidebar: {"position":"left","display":"always","offset":12,"offset_float":0,"b2t":false,"scrollpercent":false},
    fancybox: true,
    motion: true,
    duoshuo: {
      userId: '0',
      author: '博主'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="http://yjscloud.site/2017/09/13/LVS学习笔记/"/>





  <title>LVS学习笔记 | 斯堪的纳维亚</title>
</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-Hans">

  











  <div style="display: none;">
    <script src="//s95.cnzz.com/z_stat.php?id=true&web_id=true" language="JavaScript"></script>
  </div>





  
  
    
  

  <div class="container sidebar-position-left page-post-detail ">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/"  class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">斯堪的纳维亚</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <p class="site-subtitle">你不愿意改变的时候，往往就是你最需要改变的时候。</p>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav" id="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br />
            
            首页
          </a>
        </li>
      
        
        <li class="menu-item menu-item-categories">
          <a href="/categories" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-th"></i> <br />
            
            分类
          </a>
        </li>
      
        
        <li class="menu-item menu-item-about">
          <a href="/about" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-user"></i> <br />
            
            关于
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br />
            
            归档
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="/tags" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-tags"></i> <br />
            
            标签
          </a>
        </li>
      

      
        <li class="menu-item menu-item-search">
          
            <a href="javascript:;" class="st-search-show-outputs">
          
            
              <i class="menu-item-icon fa fa-search fa-fw"></i> <br />
            
            搜索
          </a>
        </li>
      
    </ul>
  

  
    <div class="site-search">
      
  <form class="site-search-form">
  <input type="text" id="st-search-input" class="st-search-input st-default-search-input" />
</form>

<script type="text/javascript">
  (function(w,d,t,u,n,s,e){w['SwiftypeObject']=n;w[n]=w[n]||function(){
    (w[n].q=w[n].q||[]).push(arguments);};s=d.createElement(t);
    e=d.getElementsByTagName(t)[0];s.async=1;s.src=u;e.parentNode.insertBefore(s,e);
  })(window,document,'script','//s.swiftypecdn.com/install/v2/st.js','_st');

  _st('install', 'xFvELz3zTWLevZ-Gjxdd','2.0.0');
</script>



    </div>
  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            

  <div id="posts" class="posts-expand">
    

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="http://yjscloud.site/2017/09/13/LVS学习笔记/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Pan">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="http://pozzv8y5g.bkt.clouddn.com/head.jpeg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="斯堪的纳维亚">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                LVS学习笔记
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2017-09-13T10:47:43+08:00">
                2017-09-13
              </time>
            

            

            
          </span>
          
            <span id="busuanzi_container_page_pv">&nbsp;&nbsp;|&nbsp;&nbsp;阅读量 <span id="busuanzi_value_page_pv"></span> 次</span>
          

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/学习笔记/" itemprop="url" rel="index">
                    <span itemprop="name">学习笔记</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
              <span class="post-comments-count">
                <span class="post-meta-divider">|</span>
                <span class="post-meta-item-icon">
                  <i class="fa fa-comment-o"></i>
                </span>
                <a class="cloud-tie-join-count" href="/2017/09/13/LVS学习笔记/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count join-count" itemprop="commentCount"></span>
                </a>
              </span>
            
          

          
          

          

          
            <div class="post-wordcount">
              
                <span class="post-meta-divider">|</span>
                <span class="post-meta-item-icon">
                  <i class="fa fa-file-word-o"></i>
                </span>
                
                  <span class="post-meta-item-text">字数统计</span>
                
                <span title="字数统计">
                  5,304
                </span>
              

              
                <span class="post-meta-divider">|</span>
              

              
                <span class="post-meta-item-icon">
                  <i class="fa fa-clock-o"></i>
                </span>
                
                  <span class="post-meta-item-text">阅读时长</span>
                
                <span title="阅读时长">
                  20
                </span>
              
            </div>
          

          

        </div>
      </header>
    

    <div class="post-body" itemprop="articleBody">

      
      

      
        <h2 id="LVS简介"><a href="#LVS简介" class="headerlink" title="LVS简介"></a>LVS简介</h2><p>   负载均衡技术有很多实现方案，有基于DNS域名轮流解析的方法、有基于客户端调度访问的方法、有基于应用层系统负载的调度方法，还有基于IP地址的调度方法。本文介绍LVS目前有三种IP负载均衡技术（VS/NAT、VS/TUN和VS/DR）。</p>
 <a id="more"></a>
<p> LVS是Linux Virtual Server的简称，也就是Linux虚拟服务器, 用现在的观点来看就是个4层（传输层tcp/udp）的负责均衡器。 它是一个由章文嵩博士发起的自由软件项目，它的官方站点是www.linuxvirtualserver.org。现在LVS已经是 Linux标准内核的一部分，在Linux2.4内核以前，使用LVS时必须要重新编译内核以支持LVS功能模块，但是从Linux2.4内核以后，已经完全内置了LVS的各个功能模块，无需给内核打任何补丁，可以直接使用LVS提供的各种功能。</p>
<p>LVS技术要达到的目标是：通过LVS提供的负载均衡技术和Linux操作系统实现一个高性能、高可用的服务器群集，它具有良好可靠性、可扩展性和可操作性。从而以低廉的成本实现最优的服务性能。<br>LVS自从1998年开始，发展到现在已经是一个比较成熟的技术项目了。可以利用LVS技术实现高可伸缩的、高可用的网络服务，例如WWW服务、Cache服务、DNS服务、FTP服务、MAIL服务、视频/音频点播服务等等，有许多比较著名网站和组织都在使用LVS架设的集群系统，例如：Linux的门户网站（www.linux.com）、向RealPlayer提供音频视频服务而闻名的Real公司（www.real.com）、全球最大的开源网站（sourceforge.net）等。  </p>
<h3 id="优点"><a href="#优点" class="headerlink" title="优点"></a>优点</h3><h4 id="功能特性"><a href="#功能特性" class="headerlink" title="功能特性"></a>功能特性</h4><p>1、抗负载能力强、是工作在网络4层之上仅作分发之用，没有流量的产生；<br>2、配置性比较低，这是一个缺点也是一个优点，因为没有可太多配置的东西，所以并不需要太多接触，大大减少了人为出错的几率；<br>3、工作稳定，自身有完整的双机热备方案；<br>4、无流量，保证了均衡器IO的性能不会收到大流量的影响；<br>5、应用范围比较广，可以对所有应用做负载均衡； </p>
<h4 id="高可用性"><a href="#高可用性" class="headerlink" title="高可用性"></a>高可用性</h4><p>LVS是一个基于内核级别的应用软件，因此具有很高的处理性能，用LVS构架的负载均衡集群系统具有优秀的处理能力，每个服务节点的故障不会影响整个系统的正常使用，同时又实现负载的合理均衡，使应用具有超高负荷的服务能力，可支持上百万个并发连接请求。如配置百兆网卡，采用VS/TUN或VS/DR调度技术，整个集群系统的吞吐量可高达1Gbits/s；如配置千兆网卡，则系统的最大吞吐量可接近10Gbits/s。</p>
<h4 id="高可靠性"><a href="#高可靠性" class="headerlink" title="高可靠性"></a>高可靠性</h4><p>LVS负载均衡集群软件已经在企业、学校等行业得到了很好的普及应用，国内外很多大型的、关键性的web站点也都采用了LVS集群软件，所以它的可靠性在实践中得到了很好的证实。有很多以LVS做的负载均衡系统，运行很长时间，从未做过重新启动。这些都说明了LVS的高稳定性和高可靠性。</p>
<h4 id="适用环境"><a href="#适用环境" class="headerlink" title="适用环境"></a>适用环境</h4><p>LVS对前端Director Server目前仅支持Linux和FreeBSD系统，但是支持大多数的TCP和UDP协议，支持TCP协议的应用有：HTTP，HTTPS ，FTP，SMTP，，POP3，IMAP4，PROXY，LDAP，SSMTP等等。支持UDP协议的应用有：DNS，NTP，ICP，视频、音频流播放协议等。<br>LVS对Real Server的操作系统没有任何限制，Real Server可运行在任何支持TCP/IP的操作系统上，包括Linux，各种Unix（如FreeBSD、Sun Solaris、HP Unix等），Mac/OS和Windows等。</p>
<h3 id="缺点"><a href="#缺点" class="headerlink" title="缺点"></a>缺点</h3><p>（1）需要网络环境的支持<br>（2）不能针对上层协议分析<br>（3）如果做成硬件会更完美</p>
<h2 id="LVS原理"><a href="#LVS原理" class="headerlink" title="LVS原理"></a>LVS原理</h2><h3 id="工作模式"><a href="#工作模式" class="headerlink" title="工作模式"></a>工作模式</h3><p>LVS的IP负载均衡技术是通过IPVS模块来实现的，IPVS是LVS集群系统的核心软件，它的主要作用是：安装在Director Server上，同时在Director Server上虚拟出一个IP地址，用户必须通过这个虚拟的IP地址访问服务。这个虚拟IP一般称为LVS的VIP，即Virtual IP。访问的请求首先经过VIP到达负载调度器，然后由负载调度器从Real Server列表中选取一个服务节点响应用户的请求。<br>当用户的请求到达负载调度器后，调度器如何将请求发送到提供服务的Real Server节点，而Real Server节点如何返回数据给用户，是IPVS实现的重点技术，IPVS实现负载均衡机制有三种，分别是NAT、TUN和DR。</p>
<p>注意：<br>director server 、ld 、lvs负责均衡器、调度器都是同一个概念<br>real server 、后端服务器也代表一个意思。</p>
<h3 id="三种转发机制介绍"><a href="#三种转发机制介绍" class="headerlink" title="三种转发机制介绍"></a>三种转发机制介绍</h3><h4 id="VS-NAT"><a href="#VS-NAT" class="headerlink" title="VS/NAT"></a>VS/NAT</h4><p>VS/NAT： 即（Virtual Server via Network Address Translation）<br>也就是网络地址翻译技术实现虚拟服务器，当用户请求到达调度器时，调度器将请求报文的目标地址（即虚拟IP地址）改写成选定的Real Server地址，同时报文的目标端口也改成选定的Real Server的相应端口，最后将报文请求发送到选定的Real Server。在服务器端得到数据后，Real Server返回数据给用户时，需要再次经过负载调度器将报文的源地址和源端口改成虚拟IP地址和相应端口，然后把数据发送给用户，完成整个负载调度过程。<br>可以看出，在NAT方式下，用户请求和响应报文都必须经过DS地址重写，当用户请求越来越多时，调度器的处理能力将称为瓶颈.<br><img src="http://ow78pfxd9.bkt.clouddn.com/VS:NAT.png" alt="VS/NAT"></p>
<h5 id="VS-NAT转发过程"><a href="#VS-NAT转发过程" class="headerlink" title="VS/NAT转发过程"></a>VS/NAT转发过程</h5><p>（1） 客户端发起请求到load balancer的虚拟ip<br>（2） load banlancer（Director）把客户请的目标地址改写为其中一个Real Server的，源地址改成不变。<br>（3）Real Server接受请求，并返回给load banlancer(Director)响应<br>（4） load banlancer(Director)接受到响应，修改目标地址为不变，源地址改成自己的。<br>（5） 客户端接受loader banlancer(Director)的响应</p>
<h5 id="VS-NAT特点"><a href="#VS-NAT特点" class="headerlink" title="VS/NAT特点"></a>VS/NAT特点</h5><p>请求和响应报文都经过Director<br>多目标的DNAT（iptables）:通过修改请求报文的目标ip地址（可能会修改目标端口）,至挑选出某RS的RIP地址实现转发</p>
<p>（1）Real Server应该和DIP应该使用私网地址，且Real Server的网关要指向DIP,</p>
<p>（2）请求和响应报文都要经由Director转发,</p>
<p>（3）支持端口映射,</p>
<p>（4）Real Server可以使用任意os,</p>
<p>（5）Real Server的RIP和Director的必须在同一网络</p>
<h4 id="文中简写字母备注-同下"><a href="#文中简写字母备注-同下" class="headerlink" title="文中简写字母备注(同下)"></a>文中简写字母备注(同下)</h4><p>调度器 ：Director ，Dispatcher,Dalancer </p>
<p>Client IP : CIP(用户IP)</p>
<p>Director Virutal ip : VIP(调度器虚拟网卡IP【外网IP】)</p>
<p>Director IP : DIP（调度器IP【对内IP】）</p>
<p>Real Serverip : RIP（真实服务器IP）</p>
<h4 id="VS-TUN"><a href="#VS-TUN" class="headerlink" title="VS/TUN"></a>VS/TUN</h4><p>即（Virtual Server via IP Tunneling）<br>也就是IP隧道技术实现虚拟服务器。它的连接调度和管理与VS/NAT方式一样，只是它的报文转发方法不同，VS/TUN方式中，调度器采用IP隧道技术将用户请求转发到某个Real Server，而这个Real Server将直接响应用户的请求，不再经过前端调度器，此外，对Real Server的地域位置没有要求，可以和Director Server位于同一个网段，也可以是独立的一个网络。因此，在TUN方式中，调度器将只处理用户的报文请求，集群系统的吞吐量大大提高。<br><img src="http://ow78pfxd9.bkt.clouddn.com/TUNNEL.png" alt="TUNNEL"></p>
<h5 id="VS-TUN转发过程"><a href="#VS-TUN转发过程" class="headerlink" title="VS/TUN转发过程"></a>VS/TUN转发过程</h5><p>（1）客户端发起请求到load balancer的虚拟ip</p>
<p>（2） load banlancer把客户的请求包包裹，然后转发给其中的一个real server</p>
<p>（3） real server接受请求、解包，得到客户端发来的原始包</p>
<p>（4） real server处理，把结果通过vip直接返回给客户端</p>
<p>（5） 客户端接受real server的响应。</p>
<p>注意：<br>（a） load balancer和real server 直接通过ip tunnel技术重新封装、解包</p>
<p>（b） load balancer和 real server 使用相同的vip</p>
<p>（c） load balnacer和real server可以不再同一个网络</p>
<h5 id="VS-TUN特点"><a href="#VS-TUN特点" class="headerlink" title="VS/TUN特点"></a>VS/TUN特点</h5><p>不修改请求报文的IP首部，而是通过在原有的IP首部（CIP&lt;–&gt;VIP）之外，再封装一个IP首部（DIP&lt;–&gt;RIP）<br>    （1）RIP,DIP,VIP全得是公网地址<br>    （2）Real Server的网关不能指向DIP<br>    （3）请求报文必须经由Director调度，但响应报文不必须不能经由Director<br>    （4）不支持端口映射<br>    （5）Real Server的os必须支持隧道功能</p>
<h4 id="VS-DR"><a href="#VS-DR" class="headerlink" title="VS/DR"></a>VS/DR</h4><p>即（Virtual Server via Direct Routing）<br>也就是用直接路由技术实现虚拟服务器。它的连接调度和管理与VS/NAT和VS/TUN中的一样，但它的报文转发方法又有不同，VS/DR通过改写请求报文的MAC地址，将请求发送到Real Server，而Real Server将响应直接返回给客户，免去了VS/TUN中的IP隧道开销。这种方式是三种负载调度机制中性能最高最好的，但是必须要求Director Server与Real Server都有一块网卡连在同一物理网段上。</p>
<p><img src="http://ow78pfxd9.bkt.clouddn.com/VS:DR.png" alt="VS/DR"></p>
<h5 id="VS-DR转发过程"><a href="#VS-DR转发过程" class="headerlink" title="VS/DR转发过程"></a>VS/DR转发过程</h5><p>（1）客户端发起请求到load balancer的虚拟ip<br>（2）load banlancer把客户发送的包，修改源mac地址为vip的，目的mac地址为real server的，然后发送给real server<br>（3）real server接受请求,并处理，然后把结果通过vip直接返回给客户端。<br>（4）客户端接受real server的响应。<br>注意<br>（a）load balancer和 real server 使用相同的vip<br>（b）load balancer和real server必须在同一个网络，因为load balancer需要知道real server的mac地址。    </p>
<h5 id="VS-DR特点"><a href="#VS-DR特点" class="headerlink" title="VS/DR特点"></a>VS/DR特点</h5><p>DR仅请求报文经由director，响应报文时由RS直接响应client,它通过修改请求报文的目标mac地址进行转发.</p>
<p>(1）保证前端路由器将目标IP为VIP的请求报文发给Director</p>
<pre><code>解决方案：
   静态绑定
   arptables
   修改RS主机内核的参数
</code></pre><p>（2）RS的RIP可以使用私有地址；但也可以使用公网地址</p>
<p>（3）RS跟Director必须在同一物理网络中</p>
<p> (4）请求报文经由Director调度，但响应报文一定不能经由Director</p>
<p>（5）不支持端口映射</p>
<p>（6）RS可以大多数OS</p>
<p>（7）RS的网关不能指向DIP</p>
<h4 id="三种转发机制的优缺点"><a href="#三种转发机制的优缺点" class="headerlink" title="三种转发机制的优缺点"></a>三种转发机制的优缺点</h4><p>◆Virtual Server via NAT</p>
<p>VS/NAT 的优点是服务器可以运行任何支持TCP/IP的操作系统，它只需要一个IP地址配置在LVS主机上，服务器组可以用私有的IP地址。缺点是它的扩充能力有限，当服务器结点数目升到20时，LVS主机本身有可能成为系统的新瓶颈，因为在VS/NAT中请求和响应封包都需要通过负载平衡LVS主机。在 Pentium 166主机上测得重写封包的平均延时为60us，假设TCP封包的平均长度为536 Bytes，则LVS主机的最大吞吐量为8.93 MBytes/s。再假设每台服务器的吞吐量为600KBytes/s，这样一个LVS主机可以带动16台服务器。</p>
<p>◆Virtual Server via IP Tunneling</p>
<p>在VS/TUN 的集群系统中，负载平衡LVS主机只将请求分配到不同的实际服务器，实际服务器将应答的资料直接返回给用户。这样，负载平衡LVS主机就可以处理巨量的请求，而不会成为系统的瓶颈。即使负载平衡LVS主机只有100Mbps的全双工网卡，虚拟服务器的最大吞吐量可以达到几Gbps。所以，VS/TUN可以极大地增加负载平衡LVS主机分配的服务器数量，它可以用来构建高性能超级服务器。VS/TUN技术对服务器的要求是所有的服务器必须支持”IP Tunneling”或者”IP Encapsulation”协议。目前，VS/TUN 的后端服务器主要运行Linux操作系统。因为”IP Tunneling”正成为各个操作系统的标准协议，所以VS/TUN也会适用运行其它操作系统的后端服务器。</p>
<p>◆Virtual Server via Direct Routing</p>
<p>同VS/TUN 一样，VS/DRLVS主机只处理客户到服务器端的连接，响应资料可以直接从独立的网络路由返回给客户。这可以极大地提高LVS集群系统的伸缩性。同 VS/TUN相比，这种方法没有IP隧道的开销，但是要求负载平衡LVS主机与实际服务器都有一块网卡连在同一物理网段上，服务器网络设备或者设备别名不作ARP响应。</p>
<p>对比结果<br><img src="http://ow78pfxd9.bkt.clouddn.com/find.png" alt="find"></p>
<h2 id="LVS的调度算法"><a href="#LVS的调度算法" class="headerlink" title="LVS的调度算法"></a>LVS的调度算法</h2><p>Director在接收到来自于Client的请求时，会基于”schedule”从RealServer中选择一个响应给Client。ipvs支持以下调度算法：（1、2为静态调度算法，3、4、5、6、7、8为动态调度算法）</p>
<p>1、 轮询（round robin, rr)</p>
<p>2．  加权轮询(Weighted round robin, wrr)：<br>新的连接请求被轮流分配至各RealServer；算法的优点是其简洁性，它无需记录当前所有连接的状态，所以它是一种无状态调度。轮叫调度算法假设所有服务器处理性能均相同，不管服务器的当前连接数和响应速度。该算法相对简单，不适用于服务器组中处理性能不一的情况，而且当请求服务时间变化比较大时，轮叫调度算法容易导致服务器间的负载不平衡。</p>
<p>2、目标地址散列调度（Destination Hashing，dh）：<br>算法也是针对目标IP地址的负载均衡，但它是一种静态映射算法，通过一个散列（Hash）函数将一个目标IP地址映射到一台服务器。目标地址散列调度算法先 根据请求的目标IP地址，作为散列键（Hash Key）从静态分配的散列表找出对应的服务器，若该服务器是可用的且未超载，将请求发送到该服务器，否则返回空。</p>
<p>3、源地址散列调度（Source Hashing，sh）：<br>算法正好与目标地址散列调度算法相反，它根据请求的源IP地址，作为散列键（Hash Key）从静态分配的散列表找出对应的服务器，若该服务器是可用的且未超载，将请求发送到该服务器，否则返回空。它采用的散列函数与目标地址散列调度算法 的相同。除了将请求的目标IP地址换成请求的源IP地址外，它的算法流程与目标地址散列调度算法的基本相似。在实际应用中，源地址散列调度和目标地址散列 调度可以结合使用在防火墙集群中，它们可以保证整个系统的唯一出入口。</p>
<p>4、最少连接(least connected, lc)， 加权最少连接(weighted least connection, wlc)：<br>新的连接请求将被分配至当前连接数最少的RealServer；最小连接调度是一种动态调度算法，它通过服务器当前所活跃的连接数来估计服务器的负载情况。调度器需要记录各个服务器已建立连接的数目，当一个请求被调度到某台服务器，其连接数加1；当连接中止或超时，其连接数减一。<br>lc：256<em>A+I=当前连接数  wlc：（256</em>A+I）/W=当前连接数   【A：活动连接数  I:非活动连接数 W：权重值】</p>
<p>5、基于局部性的最少链接调度（Locality-Based Least Connections Scheduling，lblc）：<br>针对请求报文的目标IP地址的负载均衡调度，目前主要用于Cache集群系统，因为在Cache集群中客户请求报文的目标IP地址是变化的。这里假设任何后端服务器都可以处理任一请求，算法的设计目标是在服务器的负载基本平衡情况下，将相同目标IP地址的请求调度到同一台服务器，来提高各台服务器的访问局部性和主存Cache命中率，从而整个集群系统的处理能力。LBLC调度算法先根据请求的目标IP地址找出该目标IP地址最近使用的服务器，若该服务器是可用的且没有超载，将请求发送到该服务器；若服务器不存在，或者该服务器超载且有服务器处于其一半的工作负载，则用“最少链接”的原则选出一个可用的服务器，将请求发送到该服务器。</p>
<p>6、带复制的基于局部性最少链接调度（Locality-Based Least Connections with Replication Scheduling，lblcr）：<br>也是针对目标IP地址的负载均衡，目前主要用于Cache集群系统。它与LBLC算法的不同之处是它要维护从一个目标IP地址到一组服务器的映射，而 LBLC算法维护从一个目标IP地址到一台服务器的映射。对于一个“热门”站点的服务请求，一台Cache 服务器可能会忙不过来处理这些请求。这时，LBLC调度算法会从所有的Cache服务器中按“最小连接”原则选出一台Cache服务器，映射该“热门”站点到这台Cache服务器，很快这台Cache服务器也会超载，就会重复上述过程选出新的Cache服务器。这样，可能会导致该“热门”站点的映像会出现在所有的Cache服务器上，降低了Cache服务器的使用效率。LBLCR调度算法将“热门”站点映射到一组Cache服务器（服务器集合），当该“热门”站点的请求负载增加时，会增加集合里的Cache服务器，来处理不断增长的负载；当该“热门”站点的请求负载降低时，会减少集合里的Cache服务器数目。这样，该“热门”站点的映像不太可能出现在所有的Cache服务器上，从而提供Cache集群系统的使用效率。LBLCR算法先根据请求的目标IP地址找出该目标IP地址对应的服务器组；按“最小连接”原则从该服务器组中选出一台服务器，若服务器没有超载，将请求发送到该服务器；若服务器超载；则按“最小连接”原则从整个集群中选出一台服务器，将该服务器加入到服务器组中，将请求发送到该服务器。同时，当该服务器组有一段时间没有被修改，将最忙的服务器从服务器组中删除，以降低复制的程度。</p>
<p>7、 最短的期望的延迟（Shortest Expected Delay Scheduling ,sed）<br>sed: (A+1)/w=当前连接数</p>
<p>8、最少队列调度（Never Queue Scheduling ,nq）：<br>无需队列。如果有台realserver的连接数＝0就直接分配过去，不需要在进行sed运算</p>
<h2 id="ipvsadm命令的使用"><a href="#ipvsadm命令的使用" class="headerlink" title="ipvsadm命令的使用"></a>ipvsadm命令的使用</h2><p>管理service</p>
<figure class="highlight haml"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div></pre></td><td class="code"><pre><div class="line"></div><div class="line">-<span class="ruby">A (--add-service)  添加service </span></div><div class="line"># ipvsadm -A -t 192.168.0.10:80 -s rr</div><div class="line"> </div><div class="line">-<span class="ruby">E (--edit-service)  编辑/修改service </span></div><div class="line"># ipvsadm -E -t 192.168.0.10:80 -s wlc -p 600</div><div class="line"> </div><div class="line">-<span class="ruby">D (--delete-service)  删除service </span></div><div class="line"># ipvsadm -D -t 192.168.0.10:80</div><div class="line"> </div><div class="line">-<span class="ruby">s (--scheduler)  调度算法</span></div><div class="line">-<span class="ruby">t (--tcp-service)  tcp端口</span></div><div class="line">-<span class="ruby">u (--udp-service)  udp端口</span></div><div class="line">-<span class="ruby"><span class="number">6</span> (--ipv6)  ipv6地址</span></div><div class="line">-<span class="ruby">p (--persistent)  客户端连接超时时间，默认<span class="number">360</span>秒</span></div><div class="line">-<span class="ruby">M (--netmask)  子网掩码</span></div></pre></td></tr></table></figure>
<p>补充 ：-s 参数后面接的调度算法，常见有下面8种</p>
<figure class="highlight vim"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">rr    轮询</div><div class="line">wrr   加权轮询</div><div class="line"><span class="keyword">sh</span>    源地址哈希</div><div class="line">dh    目标地址哈希</div><div class="line"><span class="keyword">lc</span>    最少连接</div><div class="line">wlc   加权最少连接</div><div class="line">sed   最少期望延迟</div><div class="line">nq    永不排队</div></pre></td></tr></table></figure>
<p>管理realserver/后端服务器</p>
<figure class="highlight haml"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line">-<span class="ruby">a (--add-server)  添加realserver</span></div><div class="line"># ipvsadm -A -t 192.168.0.10:80 -r 192.168.1.2:80 -&#123;m|g|i&#125;</div><div class="line"> </div><div class="line">-<span class="ruby">e (--add-server)  编辑/修改realserver</span></div><div class="line"># ipvsadm -A -t 192.168.0.10:80 -r 192.168.1.3:80 -m -w 2</div><div class="line"> </div><div class="line">-<span class="ruby">d (--add-server)  删除realserver</span></div><div class="line"># ipvsadm -A -t 192.168.0.10:80 -r 192.168.1.3:80</div><div class="line"> </div><div class="line">-<span class="ruby">r (--real-server)  接realserver ip地址</span></div><div class="line">-<span class="ruby">m (--gatewaying)  NAT模式</span></div><div class="line">-<span class="ruby">g (--gatewaying)  DR直接路由模式</span></div><div class="line">-<span class="ruby">i (--ipip)  IP-TUN隧道模式</span></div><div class="line">-<span class="ruby">w (--weight)  权重</span></div><div class="line">-<span class="ruby">-set [tcp tcpfin udp] 设置连接超时时间</span></div></pre></td></tr></table></figure>
<p>状态查看</p>
<figure class="highlight haml"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line">#ipvsadm -ln 是最常用的</div><div class="line">-<span class="ruby">L<span class="params">|l (--list)  查看调度器状态</span></span></div><div class="line">-<span class="ruby"><span class="params">L --timeout  显示连接超时时间[tcp tcpfin udp]</span></span></div><div class="line">-<span class="ruby"><span class="params">L --daemon   显示守护进程状态</span></span></div><div class="line">-<span class="ruby"><span class="params">L --stats    显示统计信息，收发包数量</span></span></div><div class="line">-<span class="ruby"><span class="params">L --rate     显示收发包速率</span></span></div><div class="line">-<span class="ruby"><span class="params">L --sort     排序输出</span></span></div><div class="line"> </div><div class="line">-<span class="ruby"><span class="params">n (--numeric)  不反解IP到主机名</span></span></div><div class="line">-<span class="ruby"><span class="params">c (--connection)  连接数</span></span></div></pre></td></tr></table></figure>
<p>规则/配置管理</p>
<figure class="highlight haml"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">-<span class="ruby">C (--clear)  清空当前ipvsadm配置</span></div><div class="line">-<span class="ruby">Z (--zero)  清空计数器</span></div><div class="line"> </div><div class="line">-<span class="ruby">R (--restore)  还原（导入）规则</span></div><div class="line"># ipvsadm -R &lt; /root/ipvs.config</div><div class="line"> </div><div class="line">-<span class="ruby">S (--save)  保存（导出）当前规则</span></div><div class="line"># ipvsadm -S &gt; /root/ipvs.config</div></pre></td></tr></table></figure>

      
    </div>

    <div>
      
        
<div style="text-align:center;color: #ccc;font-size:14px;">
------ 本文结束 ------</div>
<br/>
<div style="border: 1px solid black">
<div style="margin-left:10px">
<span style="font-weight:blod">版权声明</span>
<img src="http://pozzv8y5g.bkt.clouddn.com/create.png" >
<br/>
<p style="font-size: 10px;line-height: 30px"><a href="http://yjscloud.site" style="color:#258FC6">斯堪的纳维亚</a> by <a href="http://yjscloud.site" style="color:#258FC6">Pan</a> is licensed under a <a href="https://creativecommons.org/licenses/by-nc-nd/4.0/" style="color:#258FC6">Creative Commons BY-NC-ND 4.0 International License</a>.<br/>
由<a href="http://yjscloud.site" style="color:#258FC6">Pan</a>创作并维护的<a href="http://yjscloud.site" style="color:#258FC6">斯堪的纳维亚</a>博客采用<a href="https://creativecommons.org/licenses/by-nc-nd/4.0/" style="color:#258FC6">创作共用保留署名-非商业-禁止演绎4.0国际许可证</a>。<br/>
本文首发于<a href="http://yjscloud.site" style="color:#258FC6">斯堪的纳维亚</a> 博客（ <a href="http://yjscloud.site" style="color:#258FC6">http://yjscloud.site</a> ），转载请注明出处！</p>
</div>
</div>


      
    </div>


    <div>
      
        

      
    </div>

    <div>
      
        

      
    </div>

    <div>
      
        

      
    </div>
    
    <footer class="post-footer">
      
        <div class="post-tags">
          
            <a href="/tags/Linux学习笔记/" rel="tag"><i class="fa fa-tag"></i> Linux学习笔记</a>
          
            <a href="/tags/keepalived/" rel="tag"><i class="fa fa-tag"></i> keepalived</a>
          
        </div>
      

      
        
      

      
        <div class="post-nav">
          <div class="post-nav-next post-nav-item">
            
              <a href="/2017/09/15/CloudStack搭建指南（一）/" rel="next" title="CloudStack搭建指南（一）">
                <i class="fa fa-chevron-left"></i> CloudStack搭建指南（一）
              </a>
            
          </div>

          <span class="post-nav-divider"></span>

          <div class="post-nav-prev post-nav-item">
            
              <a href="/2017/05/12/Web安全防御之初探WAF/" rel="prev" title="Web安全防御之初探WAF">
                Web安全防御之初探WAF <i class="fa fa-chevron-right"></i>
              </a>
            
          </div>
        </div>
      

      
      
    </footer>
  </article>



    <div class="post-spread">
      
        <!-- JiaThis Button BEGIN -->
<div class="jiathis_style">
  <a class="jiathis_button_tsina"></a>
  <a class="jiathis_button_tqq"></a>
  <a class="jiathis_button_weixin"></a>
  <a class="jiathis_button_cqq"></a>
  <a class="jiathis_button_douban"></a>
  <a class="jiathis_button_renren"></a>
  <a class="jiathis_button_qzone"></a>
  <a class="jiathis_button_kaixin001"></a>
  <a class="jiathis_button_copy"></a>
  <a href="http://www.jiathis.com/share" class="jiathis jiathis_txt jiathis_separator jtico jtico_jiathis" target="_blank"></a>
  <a class="jiathis_counter_style"></a>
</div>
<script type="text/javascript" >
  var jiathis_config={
    hideMore:false
  }
</script>
<script type="text/javascript" src="http://v3.jiathis.com/code/jia.js" charset="utf-8"></script>
<!-- JiaThis Button END -->

      
    </div>
  </div>


          </div>
          


          
  <div class="comments" id="comments">
    
      <div id="cloud-tie-wrapper" class="cloud-tie-wrapper"></div>
    
  </div>


        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    <div class="sidebar-inner">

      

      
        <ul class="sidebar-nav motion-element">
          <li class="sidebar-nav-toc sidebar-nav-active" data-target="post-toc-wrap" >
            文章目录
          </li>
          <li class="sidebar-nav-overview" data-target="site-overview">
            站点概览
          </li>
        </ul>
      

      <section class="site-overview sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <img class="site-author-image" itemprop="image"
               src="http://pozzv8y5g.bkt.clouddn.com/head.jpeg"
               alt="Pan" />
          <p class="site-author-name" itemprop="name">Pan</p>
           
              <p class="site-description motion-element" itemprop="description">因上努力，果上随缘！</p>
          
        </div>
        <nav class="site-state motion-element">

          
            <div class="site-state-item site-state-posts">
              <a href="/archives">
                <span class="site-state-item-count">67</span>
                <span class="site-state-item-name">日志</span>
              </a>
            </div>
          

          
            
            
            <div class="site-state-item site-state-categories">
              <a href="/categories/index.html">
                <span class="site-state-item-count">6</span>
                <span class="site-state-item-name">分类</span>
              </a>
            </div>
          

          
            
            
            <div class="site-state-item site-state-tags">
              <a href="/tags/index.html">
                <span class="site-state-item-count">19</span>
                <span class="site-state-item-name">标签</span>
              </a>
            </div>
          

        </nav>

        
          <div class="feed-link motion-element">
            <a href="/atom.xml" rel="alternate">
              <i class="fa fa-rss"></i>
              RSS
            </a>
          </div>
        

        <div class="links-of-author motion-element">
          
            
              <span class="links-of-author-item">
                <a href="https://github.com/yjscloud" target="_blank" title="Github">
                  
                    <i class="fa fa-fw fa-globe"></i>
                  
                  Github
                </a>
              </span>
            
              <span class="links-of-author-item">
                <a href="http://weibo.com/5655429866" target="_blank" title="Weibo">
                  
                    <i class="fa fa-fw fa-weibo"></i>
                  
                  Weibo
                </a>
              </span>
            
              <span class="links-of-author-item">
                <a href="mailto:yjscloud@gmail.com" target="_blank" title="Email">
                  
                    <i class="fa fa-fw fa-globe"></i>
                  
                  Email
                </a>
              </span>
            
              <span class="links-of-author-item">
                <a href="https://www.zhihu.com/people/zhao-zi-long-8-52" target="_blank" title="zhihu">
                  
                    <i class="fa fa-fw fa-globe"></i>
                  
                  zhihu
                </a>
              </span>
            
          
        </div>

	<div class="swf_clock" align="center">
	  <embed name="honehoneclock" width="160" height="70" align="middle" pluginspage="http://www.macromedia.com/go/getflashplayer" src="http://chabudai.sakura.ne.jp/blogparts/honehoneclock/honehone_clock01.swf" type="application/x-shockwave-flash" wmode="transparent" quality="high" bgcolor="#000000" allowscriptaccess="always">
	</div>

        
        

        
        
          <div class="links-of-blogroll motion-element links-of-blogroll-inline">
            <div class="links-of-blogroll-title">
              <i class="fa  fa-fw fa-globe"></i>
              友情链接
            </div>
            <ul class="links-of-blogroll-list">
              
                <li class="links-of-blogroll-item">
                  <a href="http://www.cnblogs.com/yjscloud/" title="博客园" target="_blank">博客园</a>
                </li>
              
                <li class="links-of-blogroll-item">
                  <a href="http://yjscloud.site/about/" title="我的信息" target="_blank">我的信息</a>
                </li>
              
                <li class="links-of-blogroll-item">
                  <a href="https://yjscloud.com" title="GitBook" target="_blank">GitBook</a>
                </li>
              
                <li class="links-of-blogroll-item">
                  <a href="http://amon1997.com/" title="Amon的博客" target="_blank">Amon的博客</a>
                </li>
              
            </ul>
          </div>
        

        


      </section>

      
      <!--noindex-->
        <section class="post-toc-wrap motion-element sidebar-panel sidebar-panel-active">
          <div class="post-toc">

            
              
            

            
              <div class="post-toc-content"><ol class="nav"><li class="nav-item nav-level-2"><a class="nav-link" href="#LVS简介"><span class="nav-number">1.</span> <span class="nav-text">LVS简介</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#优点"><span class="nav-number">1.1.</span> <span class="nav-text">优点</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#功能特性"><span class="nav-number">1.1.1.</span> <span class="nav-text">功能特性</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#高可用性"><span class="nav-number">1.1.2.</span> <span class="nav-text">高可用性</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#高可靠性"><span class="nav-number">1.1.3.</span> <span class="nav-text">高可靠性</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#适用环境"><span class="nav-number">1.1.4.</span> <span class="nav-text">适用环境</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#缺点"><span class="nav-number">1.2.</span> <span class="nav-text">缺点</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#LVS原理"><span class="nav-number">2.</span> <span class="nav-text">LVS原理</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#工作模式"><span class="nav-number">2.1.</span> <span class="nav-text">工作模式</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#三种转发机制介绍"><span class="nav-number">2.2.</span> <span class="nav-text">三种转发机制介绍</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#VS-NAT"><span class="nav-number">2.2.1.</span> <span class="nav-text">VS/NAT</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#VS-NAT转发过程"><span class="nav-number">2.2.1.1.</span> <span class="nav-text">VS/NAT转发过程</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#VS-NAT特点"><span class="nav-number">2.2.1.2.</span> <span class="nav-text">VS/NAT特点</span></a></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#文中简写字母备注-同下"><span class="nav-number">2.2.2.</span> <span class="nav-text">文中简写字母备注(同下)</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#VS-TUN"><span class="nav-number">2.2.3.</span> <span class="nav-text">VS/TUN</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#VS-TUN转发过程"><span class="nav-number">2.2.3.1.</span> <span class="nav-text">VS/TUN转发过程</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#VS-TUN特点"><span class="nav-number">2.2.3.2.</span> <span class="nav-text">VS/TUN特点</span></a></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#VS-DR"><span class="nav-number">2.2.4.</span> <span class="nav-text">VS/DR</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#VS-DR转发过程"><span class="nav-number">2.2.4.1.</span> <span class="nav-text">VS/DR转发过程</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#VS-DR特点"><span class="nav-number">2.2.4.2.</span> <span class="nav-text">VS/DR特点</span></a></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#三种转发机制的优缺点"><span class="nav-number">2.2.5.</span> <span class="nav-text">三种转发机制的优缺点</span></a></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#LVS的调度算法"><span class="nav-number">3.</span> <span class="nav-text">LVS的调度算法</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#ipvsadm命令的使用"><span class="nav-number">4.</span> <span class="nav-text">ipvsadm命令的使用</span></a></li></ol></div>
            

          </div>
        </section>
      <!--/noindex-->
      

      
    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright" >
  
  &copy; 
  <span itemprop="copyrightYear">2019</span>
  <span class="with-love">
    <i class="icon-next-heart fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Pan

  &nbsp;&nbsp;|&nbsp;&nbsp;<span><a href="/sitemap.xml">Google网站地图</a></span>

  </span>
</div>

<script async src="https://dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js">
</script>

<script>
(function(){
    var bp = document.createElement('script');
    bp.src = '//push.zhanzhang.baidu.com/push.js';
    var s = document.getElementsByTagName("script")[0];
    s.parentNode.insertBefore(bp, s);
})();
</script>




        

        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  












  
  <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>

  
  <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>

  
  <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>

  
  <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.1.1"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.1"></script>



  
  

  
  <script type="text/javascript" src="/js/src/scrollspy.js?v=5.1.1"></script>
<script type="text/javascript" src="/js/src/post-details.js?v=5.1.1"></script>



  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.1"></script>



  


  




	





  
    
    <script>
      var cloudTieConfig = {
        url: document.location.href, 
        sourceId: "",
        productKey: "b3a09e175e704bb0a23058b39947aa9f",
        target: "cloud-tie-wrapper"
      };
    </script>
    <script src="https://img1.ws.126.net/f2e/tie/yun/sdk/loader.js"></script>
  










  





  

  
<script>
(function(){
    var bp = document.createElement('script');
    var curProtocol = window.location.protocol.split(':')[0];
    if (curProtocol === 'https') {
        bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';        
    }
    else {
        bp.src = 'http://push.zhanzhang.baidu.com/push.js';
    }
    var s = document.getElementsByTagName("script")[0];
    s.parentNode.insertBefore(bp, s);
})();
</script>


  

  

  

  </script>
<script type="text/JavaScript">
function showSubtitle()
{
  var siteNav=document.getElementById("site-nav");
  if(siteNav.style.display=="block")
  {
   var subTitle=document.getElementById("site-subtitle");
   subTitle.style.display="none";
  }else
  {
   var subTitle=document.getElementById("site-subtitle");
   subTitle.style.display="block";
  }

}
</script>

  <script type="text/javascript"> /* 鼠标特效 */ var a_idx = 0; jQuery(document).ready(function($) { $("body").click(function(e) { var a = new Array("富强", "民主", "文明", "和谐", "自由", "平等", "公正" ,"法治", "爱国", "敬业", "诚信", "友善"); var $i = $("<span/>").text(a[a_idx]); a_idx = (a_idx + 1) % a.length; var x = e.pageX, y = e.pageY; $i.css({ "z-index": 999999999999999999999999999999999999999999999999999999999999999999999, "top": y - 20, "left": x, "position": "absolute", "font-weight": "bold", "color": "#ff6651" }); $("body").append($i); $i.animate({ "top": y - 180, "opacity": 0 }, 1500, function() { $i.remove(); }); }); }); </script>
</body>
</html>
