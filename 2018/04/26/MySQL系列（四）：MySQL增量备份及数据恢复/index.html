<!doctype html>



  


<html class="theme-next mist use-motion" lang="zh-Hans">
<head>
  <meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>






<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />















  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css" />




  
  
  
  

  
    
    
  

  

  

  

  

  
    
    
    <link href="//fonts.googleapis.com/css?family=Lato:300,300italic,400,400italic,700,700italic&subset=latin,latin-ext" rel="stylesheet" type="text/css">
  






<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css" />

<link href="/css/main.css?v=5.1.1" rel="stylesheet" type="text/css" />


  <meta name="keywords" content="MySQL系列," />





  <link rel="alternate" href="/atom.xml" title="斯堪的纳维亚" type="application/atom+xml" />




  <link rel="shortcut icon" type="image/x-icon" href="http://pozzv8y5g.bkt.clouddn.com/favicon.png?v=5.1.1" />






<meta name="description" content="MySQL数据库的备份备份单个数据库练习多种参数使用mysql数据库自带了一个很好用的备份命令，就是mysqldump，它的基本使用如下： 语法： mysqldump -u 用户名 -p 数据库名&amp;gt; 备份的文件名 例1：备份名字为test2的库 1）查看备份前的数据 mysql -uroot -pyjscloud -e &amp;apos;use test;show tables;select *">
<meta name="keywords" content="MySQL系列">
<meta property="og:type" content="article">
<meta property="og:title" content="MySQL系列（四）：MySQL增量备份及数据恢复">
<meta property="og:url" content="http://yjscloud.site/2018/04/26/MySQL系列（四）：MySQL增量备份及数据恢复/index.html">
<meta property="og:site_name" content="斯堪的纳维亚">
<meta property="og:description" content="MySQL数据库的备份备份单个数据库练习多种参数使用mysql数据库自带了一个很好用的备份命令，就是mysqldump，它的基本使用如下： 语法： mysqldump -u 用户名 -p 数据库名&amp;gt; 备份的文件名 例1：备份名字为test2的库 1）查看备份前的数据 mysql -uroot -pyjscloud -e &amp;apos;use test;show tables;select *">
<meta property="og:image" content="http://p924w4b7r.bkt.clouddn.com/m-77.png">
<meta property="og:image" content="http://p924w4b7r.bkt.clouddn.com/m-78.png">
<meta property="og:image" content="http://p924w4b7r.bkt.clouddn.com/m-79.png">
<meta property="og:image" content="http://p924w4b7r.bkt.clouddn.com/m-80.png">
<meta property="og:image" content="http://p924w4b7r.bkt.clouddn.com/m-81.png">
<meta property="og:image" content="http://p924w4b7r.bkt.clouddn.com/m-82.png">
<meta property="og:image" content="http://p924w4b7r.bkt.clouddn.com/m-83.png">
<meta property="og:image" content="http://p924w4b7r.bkt.clouddn.com/m-84.png">
<meta property="og:image" content="http://p924w4b7r.bkt.clouddn.com/m-85.png">
<meta property="og:image" content="http://p924w4b7r.bkt.clouddn.com/m-86.png">
<meta property="og:image" content="http://p924w4b7r.bkt.clouddn.com/m-87.png">
<meta property="og:image" content="http://p924w4b7r.bkt.clouddn.com/m-88.png">
<meta property="og:image" content="http://p924w4b7r.bkt.clouddn.com/m-89.png">
<meta property="og:image" content="http://p924w4b7r.bkt.clouddn.com/m-90.png">
<meta property="og:image" content="http://p924w4b7r.bkt.clouddn.com/m-91.png">
<meta property="og:image" content="http://p924w4b7r.bkt.clouddn.com/m-92.png">
<meta property="og:image" content="http://p924w4b7r.bkt.clouddn.com/m-93.png">
<meta property="og:image" content="http://p924w4b7r.bkt.clouddn.com/m-94.png">
<meta property="og:image" content="http://p924w4b7r.bkt.clouddn.com/m-95.png">
<meta property="og:image" content="http://p924w4b7r.bkt.clouddn.com/m-96.png">
<meta property="og:image" content="http://p924w4b7r.bkt.clouddn.com/m-97.png">
<meta property="og:image" content="http://p924w4b7r.bkt.clouddn.com/m-98.png">
<meta property="og:image" content="http://p924w4b7r.bkt.clouddn.com/m-99.png">
<meta property="og:image" content="http://p924w4b7r.bkt.clouddn.com/m-100.png">
<meta property="og:updated_time" content="2018-08-30T04:41:05.000Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="MySQL系列（四）：MySQL增量备份及数据恢复">
<meta name="twitter:description" content="MySQL数据库的备份备份单个数据库练习多种参数使用mysql数据库自带了一个很好用的备份命令，就是mysqldump，它的基本使用如下： 语法： mysqldump -u 用户名 -p 数据库名&amp;gt; 备份的文件名 例1：备份名字为test2的库 1）查看备份前的数据 mysql -uroot -pyjscloud -e &amp;apos;use test;show tables;select *">
<meta name="twitter:image" content="http://p924w4b7r.bkt.clouddn.com/m-77.png">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Mist',
    sidebar: {"position":"left","display":"always","offset":12,"offset_float":0,"b2t":false,"scrollpercent":false},
    fancybox: true,
    motion: true,
    duoshuo: {
      userId: '0',
      author: '博主'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="http://yjscloud.site/2018/04/26/MySQL系列（四）：MySQL增量备份及数据恢复/"/>





  <title>MySQL系列（四）：MySQL增量备份及数据恢复 | 斯堪的纳维亚</title>
</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-Hans">

  











  <div style="display: none;">
    <script src="//s95.cnzz.com/z_stat.php?id=true&web_id=true" language="JavaScript"></script>
  </div>





  
  
    
  

  <div class="container sidebar-position-left page-post-detail ">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/"  class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">斯堪的纳维亚</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <p class="site-subtitle">你不愿意改变的时候，往往就是你最需要改变的时候。</p>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav" id="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br />
            
            首页
          </a>
        </li>
      
        
        <li class="menu-item menu-item-categories">
          <a href="/categories" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-th"></i> <br />
            
            分类
          </a>
        </li>
      
        
        <li class="menu-item menu-item-about">
          <a href="/about" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-user"></i> <br />
            
            关于
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br />
            
            归档
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="/tags" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-tags"></i> <br />
            
            标签
          </a>
        </li>
      

      
        <li class="menu-item menu-item-search">
          
            <a href="javascript:;" class="st-search-show-outputs">
          
            
              <i class="menu-item-icon fa fa-search fa-fw"></i> <br />
            
            搜索
          </a>
        </li>
      
    </ul>
  

  
    <div class="site-search">
      
  <form class="site-search-form">
  <input type="text" id="st-search-input" class="st-search-input st-default-search-input" />
</form>

<script type="text/javascript">
  (function(w,d,t,u,n,s,e){w['SwiftypeObject']=n;w[n]=w[n]||function(){
    (w[n].q=w[n].q||[]).push(arguments);};s=d.createElement(t);
    e=d.getElementsByTagName(t)[0];s.async=1;s.src=u;e.parentNode.insertBefore(s,e);
  })(window,document,'script','//s.swiftypecdn.com/install/v2/st.js','_st');

  _st('install', 'xFvELz3zTWLevZ-Gjxdd','2.0.0');
</script>



    </div>
  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            

  <div id="posts" class="posts-expand">
    

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="http://yjscloud.site/2018/04/26/MySQL系列（四）：MySQL增量备份及数据恢复/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Pan">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="http://pozzv8y5g.bkt.clouddn.com/head.jpeg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="斯堪的纳维亚">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                MySQL系列（四）：MySQL增量备份及数据恢复
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2018-04-26T15:31:33+08:00">
                2018-04-26
              </time>
            

            

            
          </span>
          
            <span id="busuanzi_container_page_pv">&nbsp;&nbsp;|&nbsp;&nbsp;阅读量 <span id="busuanzi_value_page_pv"></span> 次</span>
          

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/数据库学习笔记/" itemprop="url" rel="index">
                    <span itemprop="name">数据库学习笔记</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
              <span class="post-comments-count">
                <span class="post-meta-divider">|</span>
                <span class="post-meta-item-icon">
                  <i class="fa fa-comment-o"></i>
                </span>
                <a class="cloud-tie-join-count" href="/2018/04/26/MySQL系列（四）：MySQL增量备份及数据恢复/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count join-count" itemprop="commentCount"></span>
                </a>
              </span>
            
          

          
          

          

          
            <div class="post-wordcount">
              
                <span class="post-meta-divider">|</span>
                <span class="post-meta-item-icon">
                  <i class="fa fa-file-word-o"></i>
                </span>
                
                  <span class="post-meta-item-text">字数统计</span>
                
                <span title="字数统计">
                  6,772
                </span>
              

              
                <span class="post-meta-divider">|</span>
              

              
                <span class="post-meta-item-icon">
                  <i class="fa fa-clock-o"></i>
                </span>
                
                  <span class="post-meta-item-text">阅读时长</span>
                
                <span title="阅读时长">
                  29
                </span>
              
            </div>
          

          

        </div>
      </header>
    

    <div class="post-body" itemprop="articleBody">

      
      

      
        <h1 id="MySQL数据库的备份"><a href="#MySQL数据库的备份" class="headerlink" title="MySQL数据库的备份"></a>MySQL数据库的备份</h1><h2 id="备份单个数据库练习多种参数使用"><a href="#备份单个数据库练习多种参数使用" class="headerlink" title="备份单个数据库练习多种参数使用"></a>备份单个数据库练习多种参数使用</h2><p>mysql数据库自带了一个很好用的备份命令，就是mysqldump，它的基本使用如下：</p>
<p>语法：</p>
<pre><code>mysqldump -u 用户名 -p 数据库名&gt; 备份的文件名
</code></pre><p>例1：备份名字为test2的库</p>
<p>1）查看备份前的数据</p>
<pre><code>mysql -uroot -pyjscloud -e &apos;use test;show tables;select * from student;&apos;
</code></pre><p><img src="http://p924w4b7r.bkt.clouddn.com/m-77.png" alt="m-77"></p>
<p>2）执行备份命令 </p>
<pre><code>[root@mysql-1 ~]# mysqldump -uroot -pyjscloud test &gt;/opt/mysql_bak.sql
</code></pre><p>3）检查备份的结果</p>
<pre><code>egrep -v &quot;#|\*|--|^$&quot; /opt/mysql_bak.sql
</code></pre><p><img src="http://p924w4b7r.bkt.clouddn.com/m-78.png" alt="m-78"></p>
<p>例2：备份时加-B参数</p>
<pre><code>[root@mysql-1 ~]# mysqldump -uroot -pyjscloud -B test &gt;/opt/mysql_bak_B.sql
</code></pre><p>和前面备份的文件对比，看看-B参数的作用</p>
<p><img src="http://p924w4b7r.bkt.clouddn.com/m-79.png" alt="m-79"><br>提示：直观看，加-B参数的作用是增加创建数据库和连接数据库命令了，即如下两条语句：</p>
<pre><code>CREATE DATABASE /*!32312 IF NOT EXISTS*/ `test` /*!40100 DEFAULT CHARACTER SET utf8 */;
USE `test`;
</code></pre><p>利用上述加-B的备份进行恢复测试：</p>
<p><img src="http://p924w4b7r.bkt.clouddn.com/m-80.png" alt="m-80"></p>
<p>例3：优化备份文件大小减少输出注释（debug调试）</p>
<p>利用mysqldump的–compact参数优化下备份结果</p>
<p><img src="http://p924w4b7r.bkt.clouddn.com/m-81.png" alt="m-81"><br>略去输出</p>
<p>带–compact参数备份    </p>
<p><img src="http://p924w4b7r.bkt.clouddn.com/m-82.png" alt="m-82"></p>
<p>–compact参数说明（测试是使用的比较多，也可以优化输出内容的大小，让容量更少，适合调试）：<br>参数说明：该选项使得输出内容更简洁，不包括默认选项中各种注释，有如下几个参数的功能：<br>–skip-add-drop-table –no-set-name –skip-disable-keys –skip-add-locks</p>
<p>例4：指定压缩命令压缩备份的mysql数据</p>
<p><img src="http://p924w4b7r.bkt.clouddn.com/m-83.png" alt="m-83"></p>
<p>压缩效率将近3倍。通过以上例子可以得出结论</p>
<p>1）导出数据用-B参数</p>
<p>2）用gzip对备份的数据压缩</p>
<h2 id="mysqldump的工作原理"><a href="#mysqldump的工作原理" class="headerlink" title="mysqldump的工作原理"></a>mysqldump的工作原理</h2><p>利用mysqldump命令备份数据库的过程，实际上就是把数据从mysql库里以逻辑的sql语句的形式直接输出或者生产备份的文件的过程。备份的数据过滤注释，都是sql语句，结果如下：</p>
<p><img src="http://p924w4b7r.bkt.clouddn.com/m-84.png" alt="m-84"></p>
<h2 id="备份多个库及多个参数"><a href="#备份多个库及多个参数" class="headerlink" title="备份多个库及多个参数"></a>备份多个库及多个参数</h2><p>1）操作结果</p>
<p><img src="http://p924w4b7r.bkt.clouddn.com/m-85.png" alt="m-85"></p>
<p>2）-B参数说明</p>
<p>提示：-B参数是关键，表示接多个库，并且增加use db,和create database db的信息（生产环境常用）</p>
<p>参数说明：改参数用于导出若干个数据库，在备份结果中加入USE db_name 和CRETAE DATABASE ‘db_name’ -B后的参数都将被作为数据库名。该参数比较常用。当-B后的数据库列全时同-A参数</p>
<h2 id="如何做分库备份？"><a href="#如何做分库备份？" class="headerlink" title="如何做分库备份？"></a>如何做分库备份？</h2><p>分库备份实际上就是执行一个备份语句备份一个库，如果数据库里有多个库，就执行多条相同的备份单个库的备份语句就可以备份多个库了，注意每个库都可以用对应备份的库作为库名，结尾加.sql。备份多个库的命令如下：<br>分库备份：</p>
<pre><code>mysql -uroot -pyjscloud -e &apos;show databases;&apos;|grep -Evi &apos;database|infor|perfor&apos;|sed -r &apos;s#^([a-z].*$)#mysqldump -uroot -pyjscloud --events -B \1|gzip &gt;/opt/bak/\1.sql.gz#g&apos;|bash
</code></pre><h2 id="备份单个表"><a href="#备份单个表" class="headerlink" title="备份单个表"></a>备份单个表</h2><p>语法：</p>
<pre><code>mysqldump -u 用户名 -p 数据库名 表名&gt;备份的文件名
mysqldump -u root -p test student&gt;/opt/table1.sql
</code></pre><p>执行结果：</p>
<p><img src="http://p924w4b7r.bkt.clouddn.com/m-86.png" alt="m-86"><br><img src="http://p924w4b7r.bkt.clouddn.com/m-87.png" alt="m-87"></p>
<h2 id="备份多个表"><a href="#备份多个表" class="headerlink" title="备份多个表"></a>备份多个表</h2><p>语法：</p>
<pre><code>mysqldump -u 用户名 -p 数据库名 表名1 表名2&gt;备份的文件名
</code></pre><p>操作结果：</p>
<pre><code>[root@mysql-1 opt]# mysqldump -uroot -pyjscloud test course &gt;/opt/two_tables.sql
</code></pre><p>一个库里有大有小的表，有时可能需要恢复某一个小表，上述的多表备份文件很难拆开，就会像没有分库那样导致恢复某一个小表很麻烦。那又如何进行分表备份呢？如下和分库是的思想一样，每执行一条语句备份一个表，生产不同的数据文件即可，</p>
<pre><code>mysqldump -uroot -pyjscloud test student &gt; test_student.sql
mysqldump -uroot -pyjscloud test course &gt; test_course.sql
</code></pre><p>当然这种做法是很土的</p>
<h2 id="备份数据库表结构（不包含数据）"><a href="#备份数据库表结构（不包含数据）" class="headerlink" title="备份数据库表结构（不包含数据）"></a>备份数据库表结构（不包含数据）</h2><p>利用mysqldump -d参数只备份表的结构，例：备份test库的所有表的结构</p>
<p><img src="http://p924w4b7r.bkt.clouddn.com/m-88.png" alt="m-88"></p>
<p>如果只希望导出数据则用-t参数</p>
<h2 id="mysqldump的关键参数说明"><a href="#mysqldump的关键参数说明" class="headerlink" title="mysqldump的关键参数说明"></a>mysqldump的关键参数说明</h2><h3 id="关键参数：mysqldump-–help"><a href="#关键参数：mysqldump-–help" class="headerlink" title="关键参数：mysqldump –help"></a>关键参数：mysqldump –help</h3><p>-A：导出全部数据库</p>
<pre><code>--all-databases Dump all the databases. This will be same as --databases with all databases selected.
</code></pre><p>-Y： 导出全部表空间</p>
<pre><code>--all-tablespaces Dump all the tablespaces.
</code></pre><p>-y：不导出任何表空间信息</p>
<pre><code>--no-tablespaces Do not dump any tablespace information.
</code></pre><p>–add-drop-database：每个数据库创建之前添加drop数据库语句</p>
<pre><code>Add a &apos;DROP DATABASE&apos; before each create.
</code></pre><p>–add-drop-table：每个数据表创建之前添加drop数据表语句。(默认为打开状态，使用–skip-add-drop-table取消选项)</p>
<pre><code>Add a &apos;drop table&apos; before each create. 
</code></pre><p>–add-locks：在每个表导出之前增加LOCK TABLES并且之后UNLOCK  TABLE。(默认为打开状态，使用–skip-add-locks取消选项)</p>
<pre><code>Add locks around insert statements.   
</code></pre><p>–allow-keywords：允许创建是关键词的列名字。</p>
<pre><code>Allow creation of column names that are keywords.
</code></pre><p>–character-sets-dir=name：字符集文件的目录</p>
<pre><code>Directory where character sets are.
</code></pre><p>-i：附加注释信息。默认为打开，可以用–skip-comments取消 </p>
<pre><code>--comments Write additional information.
</code></pre><p>–compatible=name：导出的数据将和其它数据库或旧版本的MySQL 相兼容。值可以为ansi、mysql323、mysql40、postgresql、oracle、mssql、db2、maxdb、no_key_options、no_tables_options、no_field_options等。要使用几个值，用逗号将它们隔开。它并不保证能完全兼容，而是尽量兼容。</p>
<pre><code>Change the dump to be compatible with a given mode. By default tables are dumped in a format optimized for MySQL. Legal modes are: ansi, mysql323, mysql40, postgresql, oracle, mssql, db2, maxdb, no_key_options, no_table_options, no_field_options. One can use several modes separated by commas. Note: Requires MySQL server version 4.1.0 or higher. This option is ignored with earlier server versions.
</code></pre><p>–compact：导出更少的输出信息(用于调试)。去掉注释和头尾等结构。可以使用选项：–skip-add-drop-table  –skip-add-locks –skip-comments –skip-disable-keys</p>
<pre><code>Give less verbose output (useful for debugging). Disables structure comments and header/footer constructs.  Enables options --skip-add-drop-table --no-set-names --skip-disable-keys --skip-add-locks
</code></pre><p>-c：使用完整的insert语句(包含列名称)。这么做能提高插入效率，但是可能会受到max_allowed_packet参数的影响而导致插入失败。</p>
<pre><code>--complete-insert Use complete insert statements.
</code></pre><p>-C：在客户端和服务器之间启用压缩传递所有信息 </p>
<pre><code>--compress Use compression in server/client protocol.
</code></pre><p>–create-options：在CREATE TABLE语句中包括所有MySQL特性选项。(默认为打开状态)</p>
<pre><code>Include all MySQL specific create options.
</code></pre><p>-B：导出数据库。参数后面所有名字参量都被看作数据库名。</p>
<pre><code>--databases To dump several databases. Note the difference in usage; In this case no tables are given. All name arguments are regarded as databasenames. &apos;USE db_name;&apos; will be included in the output.
</code></pre><p>-#：输出debug信息，用于调试</p>
<pre><code>--debug[=#] This is a non-debug version. Catch this and exit
</code></pre><p>–debug-check：检查内存和打开文件使用说明并退出。</p>
<pre><code>Check memory and open file usage at exit.
</code></pre><p>–debug-info：输出调试信息并退出</p>
<pre><code>Print some debug info at exit.
</code></pre><p>–default-character-set=name：设置默认字符集</p>
<pre><code>Set the default character set.
</code></pre><p>–delayed-insert：采用延时插入方式（INSERT DELAYED）导出数据</p>
<pre><code>Insert rows with INSERT DELAYED;
</code></pre><p>–delete-master-logs：master备份后删除日志. 这个参数将自动激活–master-data。</p>
<pre><code>Delete logs on master after backup. This automatically enables --master-data.
</code></pre><p>-K：对于每个表，用/*!40000 ALTER TABLE tbl_name DISABLE KEYS */;和/*!40000 ALTER TABLE tbl_name ENABLE KEYS */;语句引用INSERT语句。这样可以更快地导入dump出来的文件，因为它是在插入所有行后创建索引的。该选项只适合MyISAM表，默认为打开状态。</p>
<pre><code>--disable-keys  &apos;/*!40000 ALTER TABLE tb_name DISABLE KEYS */; and &apos;/*!40000 ALTER TABLE tb_name ENABLE KEYS */; will be put in the output.
</code></pre><p>-E：导出事件。</p>
<pre><code>--events Dump events.
</code></pre><p>-e：使用具有多个VALUES列的INSERT语法。这样使导出文件更小，并加速导入时的速度。默认为打开状态，使用–skip-extended-insert取消选项。</p>
<pre><code>--extended-insert Allows utilization of the new, much faster INSERT syntax.
</code></pre><p>–fields-terminated-by=name：导出文件中忽略给定字段。与–tab选项一起使用，不能用于–databases和–all-databases选项</p>
<pre><code>Fields in the textfile are terminated by ...
</code></pre><p>–fields-enclosed-by=name：输出文件中的各个字段用给定字符包裹。与–tab选项一起使用，不能用于–databases和–all-databases选项</p>
<pre><code>Fields in the importfile are enclosed by ...
</code></pre><p>–fields-optionally-enclosed-by=name：输出文件中的各个字段用给定字符选择性包裹。与–tab选项一起使用，不能用于–databases和–all-databases选项</p>
<pre><code>Fields in the i.file are opt. enclosed by ...
</code></pre><p>–fields-escaped-by=name：输出文件中的各个字段忽略给定字符。与–tab选项一起使用，不能用于–databases和–all-databases选项</p>
<pre><code>Fields in the i.file are escaped by ...
</code></pre><p>-F：开始导出之前刷新日志。</p>
<pre><code>--flush-logs  Flush logs file in server before starting dump. Note that if you dump many databases at once (using the option --databases= or --all-databases), the logs will be flushed for each database dumped. The exception is when using --lock-all-tables or --master-data: in this case the logs will be flushed only once, corresponding to the moment all tables are locked. So if you want your dump and the log flush to happen at the same exact moment you should use --lock-all-tables or --master-data with --flush-logs
</code></pre><p>–flush-privileges：在导出mysql数据库之后，发出一条FLUSH  PRIVILEGES 语句。为了正确恢复，该选项应该用于导出mysql数据库和依赖mysql数据库数据的任何时候。</p>
<pre><code>Emit a FLUSH PRIVILEGES statement after dumping the mysql database.  This option should be used any time the dump contains the mysql database and any other database that depends on the data in the mysql database for proper restore.
</code></pre><p>-f：在导出过程中忽略出现的SQL错误。</p>
<pre><code>--force Continue even if we get an sql-error.
</code></pre><p>-?：显示帮助信息并退出。</p>
<pre><code>--help Display this help message and exit.
</code></pre><p>–hex-blob：使用十六进制格式导出二进制字符串字段。如果有二进制数据就必须使用该选项。影响到的字段类型有BINARY、VARBINARY、BLOB。</p>
<pre><code>Dump binary strings (BINARY, VARBINARY, BLOB) in hexadecimal format.
</code></pre><p>-h：需要导出的主机信息</p>
<pre><code>--host=name  Connect to host.
</code></pre><p>–ignore-table=name：不导出指定表。指定忽略多个表时，需要重复多次，每次一个表。每个表必须同时指定数据库和表名。例如：–ignore-table=database.table1 –ignore-table=database.table2 ……</p>
<pre><code>Do not dump the specified table. To specify more than one table to ignore, use the directive multiple times, once for each table.  Each table must be specified with both database and table names, e.g. --ignore-table=database.table
</code></pre><p>–insert-ignore：在插入行时使用INSERT IGNORE语句.</p>
<pre><code>Insert rows with INSERT IGNORE.
</code></pre><p>–lines-terminated-by=name：输出文件的每行用给定字符串划分。与–tab选项一起使用，不能用于–databases和–all-databases选项。</p>
<pre><code>Lines in the i.file are terminated by ...
</code></pre><p>-x：提交请求锁定所有数据库中的所有表，以保证数据的一致性。这是一个全局读锁，并且自动关闭–single-transaction 和–lock-tables 选项。</p>
<pre><code>--lock-all-tables Locks all tables across all databases. This is achieved by taking a global read lock for the duration of the whole dump. Automatically turns --single-transaction and --lock-tables off.
</code></pre><p>-l：开始导出前，锁定所有表。用READ  LOCAL锁定表以允许MyISAM表并行插入。对于支持事务的表例如InnoDB和BDB，–single-transaction是一个更好的选择，因为它根本不需要锁定表。请注意当导出多个数据库时，–lock-tables分别为每个数据库锁定表。因此，该选项不能保证导出文件中的表在数据库之间的逻辑一致性。不同数据库表的导出状态可以完全不同。</p>
<pre><code>--lock-tables Lock all tables for read.
</code></pre><p>–log-error=name：附加警告和错误信息到给定文件</p>
<pre><code>Append warnings and errors to given file.
</code></pre><p>–no-autocommit：使用autocommit/commit 语句包裹表</p>
<pre><code>Wrap tables with autocommit/commit statements.
</code></pre><p>-n：只导出数据，而不添加CREATE DATABASE 语句</p>
<pre><code>--no-create-db  &apos;CREATE DATABASE /*!32312 IF NOT EXISTS*/ db_name;&apos; will not be put in the output. The above line will be added otherwise, if --databases or --all-databases option was given.}.
</code></pre><p> -t：只导出数据，而不添加CREATE TABLE 语句</p>
<pre><code>--no-create-info Don&apos;t write table creation info.
</code></pre><p>-d：不导出任何数据，只导出数据库表结构</p>
<pre><code>--no-data No row information.
</code></pre><p>–opt：等同于–add-drop-table,  –add-locks, –create-options, –quick, –extended-insert, –lock-tables,  –set-charset, –disable-keys 该选项默认开启,  可以用–skip-opt禁用.</p>
<pre><code>Same as --add-drop-table, --add-locks, --create-options, --quick, --extended-insert, --lock-tables, --set-charset, and --disable-keys. Enabled by default, disable with --skip-opt.
</code></pre><p>–order-by-primary：如果存在主键，或者第一个唯一键，对每个表的记录进行排序。在导出MyISAM表到InnoDB表时有效，但会使得导出工作花费很长时间。</p>
<pre><code>Sorts each table&apos;s rows by primary key, or first unique key, if such a key exists.  Useful when dumping a MyISAM table to be loaded into an InnoDB table, but will make the dump itself take considerably longer.
</code></pre><p>-p：连接数据库密码</p>
<pre><code>--password[=name] Password to use when connecting to server. If password is not given it&apos;s solicited on the tty.
</code></pre><p>-W：使用命名管道连接mysql(windows系统可用)</p>
<pre><code>--pipe Use named pipes to connect to server.
</code></pre><p>-P：连接数据库端口号</p>
<pre><code>--port=# Port number to use for connection.
</code></pre><p>–protocol=name：使用的连接协议，包括：tcp, socket, pipe, memory.</p>
<pre><code>The protocol of connection (tcp,socket,pipe,memory).
</code></pre><p>-q：不缓冲查询，直接导出到标准输出。默认为打开状态，使用–skip-quick取消该选项</p>
<pre><code>--quick Don&apos;t buffer query, dump directly to stdout.
</code></pre><p>-Q：使用（`）引起表和列名。默认为打开状态，使用–skip-quote-names取消该选项。</p>
<pre><code>--quote-names Quote table and column names with backticks (`).
</code></pre><p>–replace：使用REPLACE INTO 取代INSERT INTO.</p>
<pre><code>Use REPLACE INTO instead of INSERT INTO.
</code></pre><p>-r：直接输出到指定文件中。该选项应该用在使用回车换行对（\r\n）换行的系统上（例如：DOS，Windows）。该选项确保只有一行被使用。</p>
<pre><code>--result-file=name Direct output to a given file. This option should be used in MSDOS, because it prevents new line &apos;\n&apos; from being converted to &apos;\r\n&apos; (carriage return + line feed).
</code></pre><p>-R：导出存储过程以及自定义函数。</p>
<pre><code>--routines Dump stored routines (functions and procedures).
</code></pre><p>–set-charset：添加’SET NAMES  default_character_set’到输出文件。默认为打开状态，使用–skip-set-charset关闭选项。</p>
<pre><code>Add &apos;SET NAMES default_character_set&apos; to the output. Enabled by default; suppress with --skip-set-charset.
</code></pre><p>-O：设置变量的值</p>
<pre><code>--set-variable=name Change the value of a variable. Please note that this option is deprecated; you can set variables directly with --variable-name=value.
</code></pre><p>–dump-date：添加DUMP时间到输出末尾</p>
<pre><code>Put a dump date to the end of the output.
</code></pre><p>–skip-opt：禁用–opt选项.</p>
<pre><code>Disable --opt. Disables --add-drop-table, --add-locks, --create-options, --quick, --extended-insert, --lock-tables, --set-charset, and --disable-keys.
</code></pre><p>-S：指定连接mysql的socket文件位置，默认路径/tmp/mysql.sock</p>
<pre><code>--socket=name Socket file to use for connection.
</code></pre><p>-T：为每个表在给定路径创建tab分割的文本文件。注意：仅仅用于mysqldump和mysqld服务器运行在相同机器上。</p>
<pre><code>--tab=name Creates tab separated textfile for each table to given path. (creates .sql and .txt files). NOTE: This only works if mysqldump is run on the same machine as the mysqld daemon.
</code></pre><p>–tables：覆盖–databases (-B)参数，指定需要导出的表名。</p>
<pre><code>Overrides option --databases (-B).
</code></pre><p>–triggers：导出触发器。该选项默认启用，用–skip-triggers禁用它。</p>
<pre><code>Dump triggers for each dumped table
</code></pre><p>–tz-utc： 在导出顶部设置时区TIME_ZONE=’+00:00’ ，以保证在不同时区导出的TIMESTAMP 数据或者数据被移动其他时区时的正确性。</p>
<pre><code>SET TIME_ZONE=&apos;+00:00&apos; at top of dump to allow dumping of TIMESTAMP data when a server has data in different time zones or data is being moved between servers with different time zones.
</code></pre><p>-u：指定连接的用户名。</p>
<pre><code>--user=name User for login if not current user.
</code></pre><p>-v：输出多种平台信息。</p>
<pre><code>--verbose Print info about the various stages.
</code></pre><p>-V：输出mysqldump版本信息并退出</p>
<pre><code>--version Output version information and exit.
</code></pre><p>-w：只转储给定的WHERE条件选择的记录。请注意如果条件包含命令解释符专用空格或字符，一定要将条件引用起来。</p>
<pre><code>--where=name Dump only selected records; QUOTES mandatory!
</code></pre><p>-X：导出XML格式.</p>
<pre><code>--xml   Dump a database as well formed XML.
</code></pre><p>–master-data：</p>
<p>  –master-data选项有3个可用值，0、1、2这三个值分别表示不同的含义</p>
<p>  此值为0：表示在使用mysqldump进行备份时，不记录对应二进制日志文件位置，将此值显示的设置为0与不使用此选项效果相同</p>
<p>  此值为1：表示在使用mysqldump进行备份时，记录二进制日志文件位置，此值为默认值，也就是说，使用–master-data与使用–master-data=1效果相同，如果将此选项的值设置为1，则会在备份文件生成对应的”CHANGE MASTER TO”，此语句中标明了备份开始时二进制日志的前缀名及其所处的位置</p>
<p>  此值为2：如果此值为2时，则会在备份文件中生成对应的”CHANGE MASTER TO”语句中添加注释（就是不生效呗），所以如果只是单纯的为备份记录二进制日志文件位置，那么将此选项设置为2即可。<br>这个参数会–lock-all-tables锁表，除非你指定了–single-transaction 这种情况下，锁表只会在dump开始的时候持续一小段时间,照理说在dump的时候，任何动作都会影响到binlog文件dump结束之后，选项会自动关闭锁表功能。简单的说，就是主从复制在做全量备份的时候，这个选项可以自动帮我们锁表和识别binlog临界文件，就不需要我们锁表，再看临界文件编号，再执行CHANGE MASTER填写binglong位置信息到从库master.info文件中了，提高了从库部署效率吧！    </p>
<h3 id="常用参数"><a href="#常用参数" class="headerlink" title="常用参数"></a>常用参数</h3><p>1）-B 指定多个库，增加建库语句和use语句</p>
<p>2）–compact 去掉注释，适合调色输出，生产不用</p>
<p>3）-A 备份所有库</p>
<p>4）-F 刷新binlog日志</p>
<p>5）–master-data 增加binlog日志文件名及对应的位置点</p>
<p>6）-x –lock-all-tables</p>
<p>7）-l –lock-tables</p>
<p>8）-d 只备份表结构</p>
<p>9）-t 只备份数据</p>
<p>10）–single-transaction 适合innodb事务数据库备份</p>
<p>innodb表在备份时，通常启用选项–single-transaction来保证备份的一致性，实际上它的工作原理是设定本次会话的隔离级别为：<br>REPEATABLE READ，以确保本次会话（dump）时，不会看到其他会话已经提交了的数据</p>
<p>myisam备份命令</p>
<pre><code>mysqldump -uroot -pyjscloud -A -B --master-data=2 -x --events|gzip &gt;/opt/all.sql.gz
</code></pre><p>innodb备份命令（推荐使用）</p>
<pre><code>mysqldump -uroot -pyjscloud -A -B --master-data=2 -x --events --single-transaction|gzip &gt;/opt/all.sql.gz
</code></pre><h1 id="MySQL数据库的恢复"><a href="#MySQL数据库的恢复" class="headerlink" title="MySQL数据库的恢复"></a>MySQL数据库的恢复</h1><h2 id="利用source命令恢复数据"><a href="#利用source命令恢复数据" class="headerlink" title="利用source命令恢复数据"></a>利用source命令恢复数据</h2><p>进入mysql数据库控制台，mysql -uroot -p 登陆后</p>
<pre><code>mysql&gt;use 数据库
</code></pre><p>然后使用source命令，后面参数为脚本文件（如这里用到的.sql）</p>
<pre><code>mysql&gt;source test_db.sql   #这个文件是系统路径，默认是登陆mysql前的系统路径
source /opt/test.sql
</code></pre><p><img src="http://p924w4b7r.bkt.clouddn.com/m-89.png" alt="m-89"><br>对于那些用gzip命令压缩的数据库文件要先解压再恢复到数据库，解压命令如下</p>
<pre><code>gzip -d [压缩的文件名]
</code></pre><h2 id="利用mysql命令恢复（标准）"><a href="#利用mysql命令恢复（标准）" class="headerlink" title="利用mysql命令恢复（标准）"></a>利用mysql命令恢复（标准）</h2><pre><code>[root@mysql-1 opt]# mysql -uroot -pyjscloud test &lt; /opt/test.sql
</code></pre><p>sql文件里面有use db这样的字样时，在导入时就有指定数据库名，否则会报错<br>如果在导出时指定了-B参数，恢复时无需指定库恢复，因为-B参数带了use test还会有create database test；而恢复时指定库就类似于use test；所以备份数据库时指定-B效果更好。</p>
<h2 id="mysql带-e参数实现非交互式对话"><a href="#mysql带-e参数实现非交互式对话" class="headerlink" title="mysql带-e参数实现非交互式对话"></a>mysql带-e参数实现非交互式对话</h2><p>1）恢复数据库</p>
<p><img src="http://p924w4b7r.bkt.clouddn.com/m-90.png" alt="m-90"><br>2）查看mysql状态</p>
<p><img src="http://p924w4b7r.bkt.clouddn.com/m-91.png" alt="m-91"><br>类似的常用命令</p>
<pre><code>show status  #查看当前会话的数据库状态信息
show global stauts;  #查看整个数据库运行状态信息，很重要，要分析并要做好监控。
showprocesslist;   #擦好看正在执行的SQL语句，看不全
show full processlist；   #查看正在执行的完整SQL语句，完整显示
set global key_buffer_size = 32777218   #不重启数据库调整数据库参数，直接生效，重启后失效。
show variables;  #查看数据库的参数信息，例如：my.cnf里参数的生效情况。
</code></pre><p>例：不重启数据库修改数据库的key_buffer参数    </p>
<p><img src="http://p924w4b7r.bkt.clouddn.com/m-92.png" alt="m-92"><br>这种状态下不重启就生效</p>
<p>要想重启生效要先在全局里面改，然后再修改配置文件</p>
<pre><code>vi /etc/my.cnf
</code></pre><p><img src="http://p924w4b7r.bkt.clouddn.com/m-93.png" alt="m-93">    </p>
<h1 id="mysqlbinlog的使用"><a href="#mysqlbinlog的使用" class="headerlink" title="mysqlbinlog的使用"></a>mysqlbinlog的使用</h1><p>mysqlbinlog是用来解析mysql的binlog日志</p>
<p>mysql的binlog日志是什么？</p>
<p>答：数据目录下的如下文件就是mysql的binlog日志</p>
<p>mysql-bin.000001</p>
<p>mysql-bin.000002</p>
<p>mysql-bin.000003</p>
<p>mysql-bin.000004</p>
<p>mysql的binlog日志作用是什么？</p>
<p>答：用来记录mysql内部增删改查等对mysql数据库有更新的内容记录。</p>
<h2 id="提取mysqlbinlog的几种方式"><a href="#提取mysqlbinlog的几种方式" class="headerlink" title="提取mysqlbinlog的几种方式"></a>提取mysqlbinlog的几种方式</h2><p>1）使用show binlog events方式可以获取当前以及指定binlog的日志，不适宜提取大量日志。<br>2）使用mysqlbinlog命令行提取(适宜批量提取日志)。</p>
<h2 id="演示show-binlog-events方式"><a href="#演示show-binlog-events方式" class="headerlink" title="演示show binlog events方式"></a>演示show binlog events方式</h2><p><img src="http://p924w4b7r.bkt.clouddn.com/m-94.png" alt="m-94"></p>
<p>1）只查看第一个binlog文件的内容(show binlog events)<br><img src="http://p924w4b7r.bkt.clouddn.com/m-95.png" alt="m-95"><br><img src="http://p924w4b7r.bkt.clouddn.com/m-96.png" alt="m-96"><br>2）查看指定binlog文件的内容(show binlog events in ‘mysql-bin.000001’)</p>
<p><img src="http://p924w4b7r.bkt.clouddn.com/m-97.png" alt="m-97"></p>
<p>3）查看当前正在写入的binlog文件(show master status\G)<br><img src="http://p924w4b7r.bkt.clouddn.com/m-98.png" alt="m-98"><br>4）获取指定位置binlog的内容(show binlog events from)</p>
<p><img src="http://p924w4b7r.bkt.clouddn.com/m-99.png" alt="m-99"></p>
<h2 id="演示mysqlbinlog方式提取binlog"><a href="#演示mysqlbinlog方式提取binlog" class="headerlink" title="演示mysqlbinlog方式提取binlog"></a>演示mysqlbinlog方式提取binlog</h2><p>1）提取指定的binlog日志</p>
<pre><code>mysqlbinlog /application/mysql/data/mysql-bin.000001
mysqlbinlog /application/mysql/data/mysql-bin.000001|grep insert
</code></pre><p><img src="http://p924w4b7r.bkt.clouddn.com/m-100.png" alt="m-100"></p>
<p>2）提取指定position位置的binlog日志</p>
<pre><code>mysqlbinlog --start-position=&quot;6626&quot; --stop-position=&quot;6731&quot;  /application/mysql/data/mysql-bin.000001
</code></pre><p>3）提取指定position位置的binlog日志并输出到压缩文件 </p>
<pre><code># mysqlbinlog --start-position=&quot;6626&quot; --stop-position=&quot;6731&quot; /application/mysql/data/mysql-bin.000001 |gzip &gt;extra_01.sql.gz 
</code></pre><p>4）提取指定position位置的binlog日志导入数据库 </p>
<pre><code># mysqlbinlog --start-position=&quot;6626&quot; --stop-position=&quot;6731&quot; /application/mysql/data/mysql-bin.000001 | mysql -uroot -p 
</code></pre><p>5）提取指定开始时间的binlog并输出到日志文件 </p>
<pre><code># mysqlbinlog --start-datetime=&quot;2018-05-15 20:15:23&quot; /application/mysql/data/mysql-bin.000001 --result-file=extra02.sql 
</code></pre><p>6）提取指定位置的多个binlog日志文件 </p>
<pre><code># mysqlbinlog --start-position=&quot;6626&quot; --stop-position=&quot;6731&quot; /o/application/mysql/data/mysql-bin.000001/application/mysql/data/mysql-bin.000002|more 
</code></pre><p>7）提取指定数据库binlog并转换字符集到UTF8 </p>
<pre><code># mysqlbinlog --database=test --set-charset=utf8 /application/mysql/data/mysql-bin.000001 /application/mysql/data/mysql-bin.000002 &gt;test.sql 
</code></pre><p>8）远程提取日志，指定结束时间  </p>
<pre><code># mysqlbinlog -urobin -p -h192.168.0.40 -P3306 --stop-datetime=&quot;2018-05-15 20:30:23&quot; --read-from-remote-server mysql-bin.000001|more 
</code></pre><p>9）远程提取使用row格式的binlog日志并输出到本地文件 </p>
<pre><code># mysqlbinlog -urobin -p -P3606 -h192.168.0.41 --read-from-remote-server -vv inst3606bin.000005 &gt;row.sql
</code></pre><h2 id="获取mysqlbinlog的帮助信息-仅列出常用选项"><a href="#获取mysqlbinlog的帮助信息-仅列出常用选项" class="headerlink" title="获取mysqlbinlog的帮助信息(仅列出常用选项)"></a>获取mysqlbinlog的帮助信息(仅列出常用选项)</h2><p>-?：–help</p>
<p>   显示帮助消息并退出。</p>
<p>-d：–database=name</p>
<p>   截取指定库的binlog。</p>
<p>-f： –force-read</p>
<p>   使用该选项，如果mysqlbinlog读它不能识别的二进制日志事件，它会打印警告，忽略该事件并继续。没有该选项，如果mysqlbinlog读到此类事件则停止。</p>
<p>-h： –host=name</p>
<p>   获取给定主机上的MySQL服务器的二进制日志。</p>
<p>-l：–local-load=name</p>
<p>   为指定目录中的LOAD DATA INFILE预处理本地临时文件。</p>
<p>-o：–offset=#</p>
<p>   跳过前N个条目。</p>
<p>-p：–password[=name]</p>
<p>   当连接服务器时使用的密码。如果使用短选项形式(-p)，选项和密码之间不能有空格。<br>   如果在命令行中–password或-p选项后面没有密码值，则提示输入一个密码。</p>
<p>-P：–port=#</p>
<p>   用于连接远程服务器的TCP/IP端口号。</p>
<p>–protocol=name</p>
<p>   使用的连接协议。</p>
<p>-R：–read-from-remote-server|–read-from-remote-master=name</p>
<p>   从MySQL服务器读二进制日志。如果未给出该选项，任何连接参数选项将被忽略，即连接到本地。<br>   这些选项是–host、–password、–port、–protocol、–socket和–user。</p>
<p>-r：–result-file=name</p>
<p>   将输出指向给定的文件。</p>
<p>-s： –short-form</p>
<p>   只显示日志中包含的语句，不显示其它信息，该方式可以缩小生成sql文件的尺寸。</p>
<p>-S： –socket=name</p>
<p>   用于连接的套接字文件。</p>
<p>–start-datetime=name</p>
<p>   从二进制日志中读取等于或晚于datetime参量的事件，datetime值相对于运行mysqlbinlog的机器上的本地时区。该值格式应符合DATETIME或TIMESTAMP数据类型。例如：2004-12-25 11:25:56 ，建议使用引号标识。</p>
<p>–stop-datetime=name</p>
<p>   从二进制日志中读取小于或等于datetime的所有日志事件。关于datetime值的描述参见–start-datetime选项。</p>
<p>-j： –start-position=#</p>
<p>   从二进制日志中第1个位置等于N参量时的事件开始读。</p>
<p>–stop-position=#</p>
<p>   从二进制日志中第1个位置等于和大于N参量时的事件起停止读。</p>
<p>–server-id=#  </p>
<p>   仅仅提取指定server_id的binlog日志</p>
<p>–set-charset=name</p>
<p>   添加SET NAMES character_set到输出     </p>
<p>-t： –to-last-log</p>
<p>   在MySQL服务器中请求的二进制日志的结尾处不停止，而是继续打印直到最后一个二进制日志的结尾。如果将输出发送给同一台MySQL服务器，会导致无限循环。该选项要求–read-from-remote-server。</p>
<p>-D： –disable-log-bin</p>
<p>   禁用二进制日志。如果使用–to-last-logs选项将输出发送给同一台MySQL服务器，可以避免无限循环。该选项在崩溃恢复时也很有用，可以避免复制已经记录的语句。注释：该选项要求有SUPER权限。</p>
<p>-u：–user=name</p>
<p>   连接远程服务器时使用的MySQL用户名。</p>
<p>-v： –verbose</p>
<p>   用于输出基于row模式的binlog日志，-vv为列数据类型添加注释</p>
<p>-V： –version</p>
<p>   显示版本信息并退出     </p>
<h1 id="常用mysqladmin命令"><a href="#常用mysqladmin命令" class="headerlink" title="常用mysqladmin命令"></a>常用mysqladmin命令</h1><p>与mysql不同的是，mysqladmin是MySQL官方提供的shell命令行工具(mysql是连接工具)，其参数都需要在shell命令行上执行。mysqladmin提供了两类参数：连接参数和命令参数，连接参数用来指定连接信息，命令参数则是服务命令。</p>
<p>mysqladmin 工具的使用格式：</p>
<pre><code>mysqladmin [option] command [command option] command ......
</code></pre><p>参数选项：</p>
<p>-c number 自动运行次数统计，必须和 -i 一起使用</p>
<p>-i number 间隔多长时间重复执行</p>
<p>0）每个两秒查看一次服务器的状态，总共重复5次。</p>
<pre><code>[root@mysql-1 ~]# mysqladmin -uroot -p -i 2 -c 5 status
</code></pre><p>1）查看服务器的状况：status</p>
<pre><code>[root@mysql-1 ~]# mysqladmin -uroot -p status
</code></pre><p>2）修改root 密码：</p>
<pre><code>[root@mysql-1 ~]# mysqladmin -u root -p原密码 password &apos;newpassword&apos;
</code></pre><p>3）检查mysqlserver是否可用：</p>
<pre><code>[root@mysql-1 ~]# mysqladmin -uroot -p ping
</code></pre><p>4）查询服务器的版本</p>
<pre><code>[rroot@mysql-1 ~]# mysqladmin -uroot -p version
</code></pre><p>5）查看服务器状态的当前值：</p>
<pre><code>[root@mysql-1 ~]# mysqladmin -uroot -p extended-status
</code></pre><p>6）查询服务器系统变量值：</p>
<pre><code>[root@mysql-1 ~]# mysqladmin -uroot -p variables
</code></pre><p>7）显示服务器所有运行的进程：</p>
<pre><code>[root@mysql-1 ~]# mysqladmin -uroot -p processlist
[root@mysql-1 ~]# mysqladmin -uroot -p-i 1 processlist        //每秒刷新一次
</code></pre><p>8）创建数据库</p>
<pre><code>[root@mysql-1 ~]# mysqladmin -uroot -p create daba-test
</code></pre><p>9）显示服务器上的所有数据库</p>
<pre><code>[root@mysql-1 ~]# mysqlshow -uroot -p
</code></pre><p>10）显示数据库daba-test下有些什么表：</p>
<pre><code>[root@mysql-1 ~]# mysqlshow -uroot -p daba-test
</code></pre><p>11）统计daba-test 下数据库表列的汇总</p>
<pre><code>[root@mysql-1 ~]# mysqlshow -uroot -p daba-test -v
</code></pre><p>12）统计daba-test 下数据库表的列数和行数</p>
<pre><code>[root@mysql-1 ~]# mysqlshow -uroot -p daba-test -v -v
</code></pre><p>13）删除数据库 daba-test</p>
<pre><code>[root@mysql-1 ~]# mysqladmin -uroot -p drop daba-test
</code></pre><p>14）重载权限信息</p>
<pre><code>[root@mysql-1 ~]# mysqladmin -uroot -p reload
</code></pre><p>15）刷新所有表缓存，并关闭和打开log</p>
<pre><code>[root@mysql-1 ~]# mysqladmin -uroot -p refresh
</code></pre><p>16）使用安全模式关闭数据库</p>
<pre><code>[root@mysql-1 ~]# mysqladmin -uroot -p shutdown
</code></pre><p>17）刷新命令mysqladmin flush commands</p>
<pre><code>[root@mysql-1 ~]# mysqladmin -u root -ptmppassword flush-hosts
[root@mysql-1 ~]# mysqladmin -u root -ptmppassword flush-logs
[root@mysql-1 ~]# mysqladmin -u root -ptmppassword flush-privileges
[root@mysql-1 ~]# mysqladmin -u root -ptmppassword flush-status
[root@mysql-1 ~]# mysqladmin -u root -ptmppassword flush-tables
[root@mysql-1 ~]# mysqladmin -u root -ptmppassword flush-threads
</code></pre><p>18）mysqladmin 执行kill 进程：</p>
<pre><code>[root@mysql-1 ~]# mysqladmin -uroot -p processlist
[root@mysql-1 ~]# mysqladmin -uroot -p kill idnum
</code></pre><p>19）停止和启动MySQL replication on a slave server</p>
<pre><code>[root@mysql-1 ~]# mysqladmin -u root -p stop-slave
[root@mysql-1 ~]# mysqladmin -u root -p start-slave
</code></pre><p>20）同时执行多个命令</p>
<pre><code>[root@mysql-1 ~]# mysqladmin -u root -p process status version
</code></pre>
      
    </div>

    <div>
      
        
<div style="text-align:center;color: #ccc;font-size:14px;">
------ 本文结束 ------</div>
<br/>
<div style="border: 1px solid black">
<div style="margin-left:10px">
<span style="font-weight:blod">版权声明</span>
<img src="http://pozzv8y5g.bkt.clouddn.com/create.png" >
<br/>
<p style="font-size: 10px;line-height: 30px"><a href="http://yjscloud.site" style="color:#258FC6">斯堪的纳维亚</a> by <a href="http://yjscloud.site" style="color:#258FC6">Pan</a> is licensed under a <a href="https://creativecommons.org/licenses/by-nc-nd/4.0/" style="color:#258FC6">Creative Commons BY-NC-ND 4.0 International License</a>.<br/>
由<a href="http://yjscloud.site" style="color:#258FC6">Pan</a>创作并维护的<a href="http://yjscloud.site" style="color:#258FC6">斯堪的纳维亚</a>博客采用<a href="https://creativecommons.org/licenses/by-nc-nd/4.0/" style="color:#258FC6">创作共用保留署名-非商业-禁止演绎4.0国际许可证</a>。<br/>
本文首发于<a href="http://yjscloud.site" style="color:#258FC6">斯堪的纳维亚</a> 博客（ <a href="http://yjscloud.site" style="color:#258FC6">http://yjscloud.site</a> ），转载请注明出处！</p>
</div>
</div>


      
    </div>


    <div>
      
        

      
    </div>

    <div>
      
        

      
    </div>

    <div>
      
        

      
    </div>
    
    <footer class="post-footer">
      
        <div class="post-tags">
          
            <a href="/tags/MySQL系列/" rel="tag"><i class="fa fa-tag"></i> MySQL系列</a>
          
        </div>
      

      
        
      

      
        <div class="post-nav">
          <div class="post-nav-next post-nav-item">
            
              <a href="/2018/04/27/MySQL系列（五）：MySQL主从复制/" rel="next" title="MySQL系列（五）：MySQL主从复制">
                <i class="fa fa-chevron-left"></i> MySQL系列（五）：MySQL主从复制
              </a>
            
          </div>

          <span class="post-nav-divider"></span>

          <div class="post-nav-prev post-nav-item">
            
              <a href="/2018/04/25/MySQL系列（三）：MySQL乱码及字符集实战/" rel="prev" title="MySQL系列（三）：MySQL乱码及字符集实战">
                MySQL系列（三）：MySQL乱码及字符集实战 <i class="fa fa-chevron-right"></i>
              </a>
            
          </div>
        </div>
      

      
      
    </footer>
  </article>



    <div class="post-spread">
      
        <!-- JiaThis Button BEGIN -->
<div class="jiathis_style">
  <a class="jiathis_button_tsina"></a>
  <a class="jiathis_button_tqq"></a>
  <a class="jiathis_button_weixin"></a>
  <a class="jiathis_button_cqq"></a>
  <a class="jiathis_button_douban"></a>
  <a class="jiathis_button_renren"></a>
  <a class="jiathis_button_qzone"></a>
  <a class="jiathis_button_kaixin001"></a>
  <a class="jiathis_button_copy"></a>
  <a href="http://www.jiathis.com/share" class="jiathis jiathis_txt jiathis_separator jtico jtico_jiathis" target="_blank"></a>
  <a class="jiathis_counter_style"></a>
</div>
<script type="text/javascript" >
  var jiathis_config={
    hideMore:false
  }
</script>
<script type="text/javascript" src="http://v3.jiathis.com/code/jia.js" charset="utf-8"></script>
<!-- JiaThis Button END -->

      
    </div>
  </div>


          </div>
          


          
  <div class="comments" id="comments">
    
      <div id="cloud-tie-wrapper" class="cloud-tie-wrapper"></div>
    
  </div>


        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    <div class="sidebar-inner">

      

      
        <ul class="sidebar-nav motion-element">
          <li class="sidebar-nav-toc sidebar-nav-active" data-target="post-toc-wrap" >
            文章目录
          </li>
          <li class="sidebar-nav-overview" data-target="site-overview">
            站点概览
          </li>
        </ul>
      

      <section class="site-overview sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <img class="site-author-image" itemprop="image"
               src="http://pozzv8y5g.bkt.clouddn.com/head.jpeg"
               alt="Pan" />
          <p class="site-author-name" itemprop="name">Pan</p>
           
              <p class="site-description motion-element" itemprop="description">因上努力，果上随缘！</p>
          
        </div>
        <nav class="site-state motion-element">

          
            <div class="site-state-item site-state-posts">
              <a href="/archives">
                <span class="site-state-item-count">67</span>
                <span class="site-state-item-name">日志</span>
              </a>
            </div>
          

          
            
            
            <div class="site-state-item site-state-categories">
              <a href="/categories/index.html">
                <span class="site-state-item-count">6</span>
                <span class="site-state-item-name">分类</span>
              </a>
            </div>
          

          
            
            
            <div class="site-state-item site-state-tags">
              <a href="/tags/index.html">
                <span class="site-state-item-count">19</span>
                <span class="site-state-item-name">标签</span>
              </a>
            </div>
          

        </nav>

        
          <div class="feed-link motion-element">
            <a href="/atom.xml" rel="alternate">
              <i class="fa fa-rss"></i>
              RSS
            </a>
          </div>
        

        <div class="links-of-author motion-element">
          
            
              <span class="links-of-author-item">
                <a href="https://github.com/yjscloud" target="_blank" title="Github">
                  
                    <i class="fa fa-fw fa-globe"></i>
                  
                  Github
                </a>
              </span>
            
              <span class="links-of-author-item">
                <a href="http://weibo.com/5655429866" target="_blank" title="Weibo">
                  
                    <i class="fa fa-fw fa-weibo"></i>
                  
                  Weibo
                </a>
              </span>
            
              <span class="links-of-author-item">
                <a href="mailto:yjscloud@gmail.com" target="_blank" title="Email">
                  
                    <i class="fa fa-fw fa-globe"></i>
                  
                  Email
                </a>
              </span>
            
              <span class="links-of-author-item">
                <a href="https://www.zhihu.com/people/zhao-zi-long-8-52" target="_blank" title="zhihu">
                  
                    <i class="fa fa-fw fa-globe"></i>
                  
                  zhihu
                </a>
              </span>
            
          
        </div>

	<div class="swf_clock" align="center">
	  <embed name="honehoneclock" width="160" height="70" align="middle" pluginspage="http://www.macromedia.com/go/getflashplayer" src="http://chabudai.sakura.ne.jp/blogparts/honehoneclock/honehone_clock01.swf" type="application/x-shockwave-flash" wmode="transparent" quality="high" bgcolor="#000000" allowscriptaccess="always">
	</div>

        
        

        
        
          <div class="links-of-blogroll motion-element links-of-blogroll-inline">
            <div class="links-of-blogroll-title">
              <i class="fa  fa-fw fa-globe"></i>
              友情链接
            </div>
            <ul class="links-of-blogroll-list">
              
                <li class="links-of-blogroll-item">
                  <a href="http://www.cnblogs.com/yjscloud/" title="博客园" target="_blank">博客园</a>
                </li>
              
                <li class="links-of-blogroll-item">
                  <a href="http://yjscloud.site/about/" title="我的信息" target="_blank">我的信息</a>
                </li>
              
                <li class="links-of-blogroll-item">
                  <a href="https://yjscloud.com" title="GitBook" target="_blank">GitBook</a>
                </li>
              
                <li class="links-of-blogroll-item">
                  <a href="http://amon1997.com/" title="Amon的博客" target="_blank">Amon的博客</a>
                </li>
              
            </ul>
          </div>
        

        


      </section>

      
      <!--noindex-->
        <section class="post-toc-wrap motion-element sidebar-panel sidebar-panel-active">
          <div class="post-toc">

            
              
            

            
              <div class="post-toc-content"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#MySQL数据库的备份"><span class="nav-number">1.</span> <span class="nav-text">MySQL数据库的备份</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#备份单个数据库练习多种参数使用"><span class="nav-number">1.1.</span> <span class="nav-text">备份单个数据库练习多种参数使用</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#mysqldump的工作原理"><span class="nav-number">1.2.</span> <span class="nav-text">mysqldump的工作原理</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#备份多个库及多个参数"><span class="nav-number">1.3.</span> <span class="nav-text">备份多个库及多个参数</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#如何做分库备份？"><span class="nav-number">1.4.</span> <span class="nav-text">如何做分库备份？</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#备份单个表"><span class="nav-number">1.5.</span> <span class="nav-text">备份单个表</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#备份多个表"><span class="nav-number">1.6.</span> <span class="nav-text">备份多个表</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#备份数据库表结构（不包含数据）"><span class="nav-number">1.7.</span> <span class="nav-text">备份数据库表结构（不包含数据）</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#mysqldump的关键参数说明"><span class="nav-number">1.8.</span> <span class="nav-text">mysqldump的关键参数说明</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#关键参数：mysqldump-–help"><span class="nav-number">1.8.1.</span> <span class="nav-text">关键参数：mysqldump –help</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#常用参数"><span class="nav-number">1.8.2.</span> <span class="nav-text">常用参数</span></a></li></ol></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#MySQL数据库的恢复"><span class="nav-number">2.</span> <span class="nav-text">MySQL数据库的恢复</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#利用source命令恢复数据"><span class="nav-number">2.1.</span> <span class="nav-text">利用source命令恢复数据</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#利用mysql命令恢复（标准）"><span class="nav-number">2.2.</span> <span class="nav-text">利用mysql命令恢复（标准）</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#mysql带-e参数实现非交互式对话"><span class="nav-number">2.3.</span> <span class="nav-text">mysql带-e参数实现非交互式对话</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#mysqlbinlog的使用"><span class="nav-number">3.</span> <span class="nav-text">mysqlbinlog的使用</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#提取mysqlbinlog的几种方式"><span class="nav-number">3.1.</span> <span class="nav-text">提取mysqlbinlog的几种方式</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#演示show-binlog-events方式"><span class="nav-number">3.2.</span> <span class="nav-text">演示show binlog events方式</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#演示mysqlbinlog方式提取binlog"><span class="nav-number">3.3.</span> <span class="nav-text">演示mysqlbinlog方式提取binlog</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#获取mysqlbinlog的帮助信息-仅列出常用选项"><span class="nav-number">3.4.</span> <span class="nav-text">获取mysqlbinlog的帮助信息(仅列出常用选项)</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#常用mysqladmin命令"><span class="nav-number">4.</span> <span class="nav-text">常用mysqladmin命令</span></a></li></ol></div>
            

          </div>
        </section>
      <!--/noindex-->
      

      
    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright" >
  
  &copy; 
  <span itemprop="copyrightYear">2019</span>
  <span class="with-love">
    <i class="icon-next-heart fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Pan

  &nbsp;&nbsp;|&nbsp;&nbsp;<span><a href="/sitemap.xml">Google网站地图</a></span>

  </span>
</div>

<script async src="https://dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js">
</script>

<script>
(function(){
    var bp = document.createElement('script');
    bp.src = '//push.zhanzhang.baidu.com/push.js';
    var s = document.getElementsByTagName("script")[0];
    s.parentNode.insertBefore(bp, s);
})();
</script>




        

        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  












  
  <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>

  
  <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>

  
  <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>

  
  <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.1.1"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.1"></script>



  
  

  
  <script type="text/javascript" src="/js/src/scrollspy.js?v=5.1.1"></script>
<script type="text/javascript" src="/js/src/post-details.js?v=5.1.1"></script>



  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.1"></script>



  


  




	





  
    
    <script>
      var cloudTieConfig = {
        url: document.location.href, 
        sourceId: "",
        productKey: "b3a09e175e704bb0a23058b39947aa9f",
        target: "cloud-tie-wrapper"
      };
    </script>
    <script src="https://img1.ws.126.net/f2e/tie/yun/sdk/loader.js"></script>
  










  





  

  
<script>
(function(){
    var bp = document.createElement('script');
    var curProtocol = window.location.protocol.split(':')[0];
    if (curProtocol === 'https') {
        bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';        
    }
    else {
        bp.src = 'http://push.zhanzhang.baidu.com/push.js';
    }
    var s = document.getElementsByTagName("script")[0];
    s.parentNode.insertBefore(bp, s);
})();
</script>


  

  

  

  </script>
<script type="text/JavaScript">
function showSubtitle()
{
  var siteNav=document.getElementById("site-nav");
  if(siteNav.style.display=="block")
  {
   var subTitle=document.getElementById("site-subtitle");
   subTitle.style.display="none";
  }else
  {
   var subTitle=document.getElementById("site-subtitle");
   subTitle.style.display="block";
  }

}
</script>

  <script type="text/javascript"> /* 鼠标特效 */ var a_idx = 0; jQuery(document).ready(function($) { $("body").click(function(e) { var a = new Array("富强", "民主", "文明", "和谐", "自由", "平等", "公正" ,"法治", "爱国", "敬业", "诚信", "友善"); var $i = $("<span/>").text(a[a_idx]); a_idx = (a_idx + 1) % a.length; var x = e.pageX, y = e.pageY; $i.css({ "z-index": 999999999999999999999999999999999999999999999999999999999999999999999, "top": y - 20, "left": x, "position": "absolute", "font-weight": "bold", "color": "#ff6651" }); $("body").append($i); $i.animate({ "top": y - 180, "opacity": 0 }, 1500, function() { $i.remove(); }); }); }); </script>
</body>
</html>
